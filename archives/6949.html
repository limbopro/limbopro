
<!DOCTYPE HTML>
<html class="small-scroll-bar no-js bg cool-transparent" lang="zh-Hans">
<head>

<link rel="preload" href="../usr/themes/handsome/assets/libs/bootstrap/css/bootstrap.min.css" as="style">
<link rel="preload" href="../usr/themes/handsome/assets/css/origin/function.min.css" as="style">
<link rel="preload" href="../usr/themes/handsome/assets/css/handsome.min.css" as="style">
<link rel="preload" href="../usr/themes/handsome/assets/css/features/coolopacity.min.css" as="style">
<link rel="preload" href="../usr/themes/handsome/assets/css/features/dark.min.css" as="style">
<link rel="preload" href="../usr/themes/handsome/assets/css/limbopro.css" as="style">
<link rel="preload" href="../usr/plugins/TableOfContents/css/toc_style.css" as="style">
<link rel="preload" href="https://limbopro.com/usr/themes/handsome/assets/libs/bootstrap/fonts/glyphicons-halflings-regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://limbopro.com/usr/themes/handsome/assets/fonts/fontello/fontello.woff" as="font" type="font/woff" crossorigin="anonymous">



<title>DDoS/CC攻击防御丨Cloudflare API - 毒奶 - 欢迎使用代理访问本站。</title>
<meta name="title" content="DDoS/CC攻击防御丨Cloudflare API - 毒奶 - 欢迎使用代理访问本站。">
<meta name="author" content="毒奶">
<meta name="description" content="毒奶搜索,毒奶导航,机场推荐,建站与维护,DDoS防御(Cloudflare),LNMP,SEO,技术分享,番号搜索,番号推荐,NSFW.">
<meta name="image" content="https://limbopro.com/usr/uploads/2019/12/2377344071.jpg">

<meta itemprop="name" content="DDoS/CC攻击防御丨Cloudflare API - 毒奶 - 欢迎使用代理访问本站。">
<meta itemprop="author" content="毒奶">
<meta itemprop="description" content="毒奶搜索,毒奶导航,机场推荐,建站与维护,DDoS防御(Cloudflare),LNMP,SEO,技术分享,番号搜索,番号推荐,NSFW.">
<meta itemprop="image" content="https://limbopro.com/usr/uploads/2019/12/2377344071.jpg">

<meta property="og:url" content="https://limbopro.com/archives/6949.html">
<meta property="og:type" content="website">
<meta property="og:title" content="DDoS/CC攻击防御丨Cloudflare API - 毒奶 - 欢迎使用代理访问本站。">
<meta property="og:description" content="毒奶搜索,毒奶导航,机场推荐,建站与维护,DDoS防御(Cloudflare),LNMP,SEO,技术分享,番号搜索,番号推荐,NSFW.">
<meta property="og:image" content="https://limbopro.com/usr/uploads/2019/12/2377344071.jpg">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@limboprossr">
<meta name="twitter:creator" content="@limboprossr">
<meta name="twitter:title" content="DDoS/CC攻击防御丨Cloudflare API - 毒奶 - 欢迎使用代理访问本站。">
<meta name="twitter:description" content="毒奶搜索,毒奶导航,机场推荐,建站与维护,DDoS防御(Cloudflare),LNMP,SEO,技术分享,番号搜索,番号推荐,NSFW.">
<meta property="twitter:image" content="https://limbopro.com/usr/uploads/2019/12/2377344071.jpg">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<meta charset="UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">

<meta name="renderer" content="webkit">

<meta name="theme-color" content="#000000" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://www.doubleclickbygoogle.com/" />
<link rel="dns-prefetch" href="https://www.google.com/" />
<link rel="dns-prefetch" href="https://marketingplatform.google.com/" />
<link rel="dns-prefetch" href="https://developers.google.com/" />
<link rel="dns-prefetch" href="https://api.ip.sb/" />
<link rel="dns-prefetch" href="https://adservice.google.com/" />
<link rel="dns-prefetch" href="https://ajax.cloudflare.com/" />
<link rel="dns-prefetch" href="https://pagead2.googlesyndication.com/" />
<link rel="dns-prefetch" href="https://www.google-analytics.com/" />
<link rel="dns-prefetch" href="https://googleads.g.doubleclick.net/" />
<link rel="dns-prefetch" href="https://twitter.com/" />
<link rel="dns-prefetch" href="https://platform.twitter.com/" />
<link rel="dns-prefetch" href="https://ssl.gstaic.com/" />



<title>DDoS/CC攻击防御丨Cloudflare API - 毒奶 - 欢迎使用代理访问本站。</title>
<link rel="icon" type="image/ico" href="https://limbopro.com/favicon.ico">
<link rel="stylesheet" type="text/css" href="../usr/plugins/TableOfContents/css/toc_style.css" />

<script type="application/ld+json">
    {
    "@context" : "http://schema.org",
    "@type" : "Article",
    "headline" : "DDoS/CC攻击防御丨Cloudflare API - 毒奶 - 欢迎使用代理访问本站。",
        "description" : "毒奶搜索,毒奶导航,机场推荐,建站与维护,DDoS防御(Cloudflare),LNMP,SEO,技术分享,番号搜索,番号推荐,NSFW.",
        "keywords" : "DDOS,Cloudflare,脚本,CCkiller,API",
    "author" : [{
    "@type" : "Person",
    "name" : "推特账号",
    "url" : "https://twitter.com/limboprossr"
    },{
    "@type" : "Person",
    "name" : "电报频道",
    "url" : "https://t.me/limboprossr"
    },{
    "@type" : "Person",
    "name" : "Instagram",
    "url" : "https://www.instagram.com/limboprossr"
    }],
    "datePublished" : "2020-01-03",
    "dateModified" : "2021-04-05",
    "inLanguage":["zh"],
        "image" : "https://limbopro.com/usr/uploads/2019/12/2377344071.jpg",
        "url" : "https://limbopro.com/archives/6949.html",
    "publisher" : {
    "@type" : "Organization",
    "name" : "毒奶.inc Copyright"
    }
    }
    </script>

<style>
    /*disqus Ads block with CSS*/
    iframe[sandbox*="allow"]{display:none!important;}
    </style>

<script type="text/javascript">
    
        window['LocalConst'] = {
            //base
            BASE_SCRIPT_URL: 'https://limbopro.com/usr/themes/handsome/',
            BLOG_URL: 'https://limbopro.com/',
            BLOG_URL_N: 'https://limbopro.com',
            STATIC_PATH: 'https://limbopro.com/usr/themes/handsome/assets/',
            BLOG_URL_PHP: 'https://limbopro.com/',
            VDITOR_CDN: 'https://cdn.jsdelivr.net/npm/vditor@3.4.5',
            MATHJAX_SVG_CDN: 'https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-svg.js',
            THEME_VERSION: '7.3.12020081501',
            THEME_VERSION_PRO: '7.3.1',

            //comment
            COMMENT_NAME_INFO: '必须填写昵称或姓名',
            COMMENT_EMAIL_INFO: '必须填写电子邮箱地址',
            COMMENT_EMAIL_LEGAL_INFO: '邮箱地址不合法',
            COMMENT_CONTENT_INFO: '必须填写评论内容',
            COMMENT_SUBMIT_ERROR: '提交失败，请重试！',
            COMMENT_CONTENT_LEGAL_INFO: '提交失败,评论被拦截或者进入审核区域',
            COMMENT_CONTENT_CHECK_INFO: '评论进入审核区域，请勿重复评论',
            COMMENT_TITLE: '评论通知',

            //login
            LOGIN_TITLE: '登录通知',
            LOGIN_USERNAME_INFO: '必须填写用户名',
            LOGIN_PASSWORD_INFO: '请填写密码',
            LOGIN_SUBMIT_ERROR: '登录失败，请重新登录',
            LOGIN_SUBMIT_INFO: '用户名或者密码错误，请重试',
            LOGIN_SUBMIT_SUCCESS: '登录成功',
            CLICK_TO_REFRESH: '点击以刷新页面',
            LOGOUT_SUCCESS_REFRESH: '退出成功，正在刷新当前页面',

            LOGOUT_ERROR: '退出失败，请重试',
            LOGOUT_SUCCESS: '退出成功',
            SUBMIT_PASSWORD_INFO: '密码错误，请重试',

            //comment
            ChANGYAN_APP_KEY: '',
            CHANGYAN_CONF: '',

            COMMENT_SYSTEM: '2',
            COMMENT_SYSTEM_ROOT: '0',
            COMMENT_SYSTEM_CHANGYAN: '1',
            COMMENT_SYSTEM_OTHERS: '2',
            EMOJI: '表情',
            COMMENT_NEED_EMAIL: '0',
            COMMENT_REJECT_PLACEHOLDER: '居然什么也不说，哼',
            COMMENT_PLACEHOLDER: '说点什么吧……',

            //pjax
            IS_PJAX: '1',
            IS_PAJX_COMMENT: '',
            PJAX_ANIMATE: 'default',
            PJAX_TO_TOP: '0',
            TO_TOP_SPEED: '100',


            USER_COMPLETED: {"data":""},

            //ui
            OPERATION_NOTICE: '操作通知',
            SCREENSHOT_BEGIN: '正在生成当前页面截图……',
            SCREENSHOT_NOTICE: '点击顶部下载按钮保存当前卡片',
            SCREENSHORT_ERROR: '由于图片跨域原因导致截图失败',
            SCREENSHORT_SUCCESS: '截图成功',

            //music
            MUSIC_NOTICE: '播放通知',
            MUSIC_FAILE: '当前音乐地址无效，自动为您播放下一首',
            MUSIC_FAILE_END: '当前音乐地址无效',
            MUSIC_LIST_SUCCESS: '歌单歌曲加载成功',

            //option
            TOC_TITLE: '文章目录',
            HEADER_FIX: '固定头部',
            ASIDE_FIX: '固定导航',
            ASIDE_FOLDED: '折叠导航',
            ASIDE_DOCK: '置顶导航',
            CONTAINER_BOX: '盒子模型',
            DARK_MODE: '深色模式',
            DARK_MODE_AUTO: '深色模式（自动）',
            DARK_MODE_FIXED: '深色模式（固定）',
            EDITOR_CHOICE: 'origin',


            CDN_NAME: '',
            LAZY_LOAD: '',
            PAGE_ANIMATE: '',
            THEME_COLOR: '14',
            THEME_COLOR_EDIT: 'black-black-black',
            THEME_HEADER_FIX: '1',
            THEME_ASIDE_FIX: '1',
            THEME_ASIDE_FOLDED: '',
            THEME_ASIDE_DOCK: '',
            THEME_CONTAINER_BOX: '1',
            THEME_HIGHLIGHT_CODE: '1',
            THEME_MATHJAX: '1',
            THEME_TOC: '',
            THEME_DARK_MODE: 'light',
            THEME_DARK_MODE_VALUE: 'light',
            SHOW_SETTING_BUTTON: '1',

            THEME_DARK_HOUR: '18',
            THEME_LIGHT_HOUR: '6',
            THUMB_STYLE: '',
            AUTO_READ_MODE: '',

            //代码高亮
            CODE_STYLE_LIGHT: 'dracula',
            CODE_STYLE_DARK: 'dracula',

            //other
            OFF_SCROLL_HEIGHT: '50',
            SHOW_IMAGE_ALT: '1',
            USER_LOGIN: '',
            USE_CACHE: '',
            POST_SPEECH: '1',
        };

        if ('serviceWorker' in navigator) {
            if (LocalConst.USE_CACHE) {
                navigator.serviceWorker.register(LocalConst.BLOG_URL + 'sw.min.js?v=7.3.12020081501')
                    .then(function (reg) {

                    }).catch(function (error) {
                    console.log('cache failed with ' + error); // registration failed
                });
            } else {
                navigator.serviceWorker.getRegistrations()
                    .then(function (registrations) {
                        for (let registration of registrations) {
                            registration.unregister();
                            // 清除缓存
                            window.caches && caches.keys && caches.keys().then(function (keys) {
                                keys.forEach(function (key) {
                                    caches.delete(key);
                                });
                            });
                            console.log("unregister success")
                        }
                    });
            }
        }
    </script>
<script>
            MathJax = {
                tex:{
                    inlineMath: [['$', '$'], ['\\(', '\\)']],
                    macros: {
                        bf: '{\\boldsymbol f}',
                        bu: '{\\boldsymbol u}',
                        bv: '{\\boldsymbol v}',
                        bw: '{\\boldsymbol w}'
                    }
                },
                svg:{
                    fontCache: 'global'
                }
            };
        </script>

<link href="../usr/themes/handsome/assets/libs/bootstrap/css/bootstrap.min.css" rel="stylesheet">

<link rel="stylesheet" href="../usr/themes/handsome/assets/css/origin/function.min.css" type="text/css" />
<link rel="stylesheet" href="../usr/themes/handsome/assets/css/handsome.min.css" type="text/css" />

<link rel="stylesheet" href="../usr/themes/handsome/assets/css/features/coolopacity.min.css" type="text/css" />
<style>
                .cool-transparent .app:before {
                    background-color: rgba(0 , 0, 0, 1) !important;
                    filter: blur(20px);
                }
            </style>

<style type="text/css">
        
        html.bg {
        background: rgba(0 , 0, 0, 1)
        }
        .cool-transparent .off-screen+* .app-content-body {
        background: rgba(0 , 0, 0, 1)
        }
@media (max-width:767px){
    html.bg {
        background: rgba(0 , 0, 0, 1)
        }
        .cool-transparent .off-screen+* .app-content-body {
        background: rgba(0 , 0, 0, 1)
        }
}
#toc {
    background: rgba(255, 255, 255, 0.3);
}    .nav-tabs-alt .nav-tabs>li[data-index="2"].active~.navs-slider-bar {
        transform: translateX(405%);
    }
    .nav-tabs-alt .nav-tabs>li[data-index="0"].active~.navs-slider-bar {
        transform: translateX(100%);
    }#aside .wrapper:hover {
	background: url(../usr/themes/handsome/assets/img/snow.gif);
	background-size: cover;
	color: #999;
}    </style>

<script src="../usr/themes/handsome/assets/libs/jquery/jquery.min.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-P2GKCC61G7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-P2GKCC61G7');
</script>




<script async src="https://cse.google.com/cse.js?cx=c8ba9e10f156f7aff"></script>


</head>
<body id="body" class="fix-padding">



<style>
.gsc-control-cse .gs-spelling, .gsc-control-cse .gs-result .gs-title, .gsc-control-cse .gs-result .gs-title *{background:white !important}
input.gsc-input {color:black !important}
</style> 
<div id="alllayout" class="app app-aside-fix container app-header-fixed "> 
<header id="header" class="app-header navbar box-shadow-bottom-lg" role="menu">

<div class="text-ellipsis navbar-header bg-black">
<button class="pull-right visible-xs" onclick="window.open('https://bit.ly/39oJwJE','_blank');">
<span class="menu-icons"><i data-feather="search"></i></span>
</button>
<button class="pull-left visible-xs" ui-toggle-class="off-screen animated" target=".app-aside" ui-scroll="app">
<span class="menu-icons"><i data-feather="menu"></i></span>
</button>

<a href="../index.html" class="navbar-brand text-lt">
<span id="navbar-brand-day">
<i class="fontello fontello-home"></i>
<span class="hidden-folded m-l-xs">It's limboPro.com</span>
</span>
</a>

</div>


<div class="collapse pos-rlt navbar-collapse bg-black">



<ul class="nav navbar-nav navbar-right">
<li class="dropdown"><a target="blank" href="https://t.me/limboprobot" class="dropdown-toggle"><i class="fontello-chat-alt icon-fw"></i><span class="visible-xs-inline">相册</span></a></li> 
<li class="dropdown">
<a href="6949.html#" data-toggle="dropdown" class="feathericons dropdown-toggle">
<i data-feather="twitch"></i>
<span class="visible-xs-inline">
闲言碎语 </span>
<span class="badge badge-sm up bg-danger pull-right-xs"></span>
</a>

<div class="dropdown-menu w-xl animated fadeInUp">
<div class="panel bg-white">
<div class="panel-heading b-light bg-light">
<strong>
闲言碎语 </strong>
</div>
<div class="list-group" id="smallRecording">
<a href="https://limbopro.com//cross.html" class="list-group-item"><span class="clear block m-b-none">这是一条默认的说说，如果你看到这条动态，请去后台新建独立页面，地址填写cross,自定义模板选择时光机。具体说明请参见主题的使用攻略。<br><small class="text-muted">March 10th, 2022 a 01:14 am</small></span></a> </div>
</div>
</div>
</li>

</ul>
</div>

</header>


<aside id="aside" class="app-aside hidden-xs bg-black"> 
<div class="aside-wrap" layout="column">
<div class="navi-wrap scroll-y scroll-hide" flex>

<div class="clearfix hidden-xs text-center hide  show" id="aside-user">
<div class="dropdown wrapper ">
<div ui-nav>
<a href="https://t.me/s/limboprossr">
<span class="thumb-lg w-auto-folded avatar m-t-sm  ">
<img src="../usr/uploads/2019/09/2211209831.jpg" class="img-full img-circle normal-shadow">
</span>
</a>
</div>
<a href="6949.html#" data-toggle="dropdown" class="dropdown-toggle hidden-folded  ">
<span class="clear">
<span class="block m-t-sm">
<strong class="font-bold text-lt">毒奶</strong>
<b class="caret"></b>
</span>
<span class="text-muted text-xs block">
网上冲浪爱好者<br>业余斜杆青年<br>建站与防御<br>NSFW</span>
</span>
</a>

<ul class="dropdown-menu animated fadeInRight w hidden-folded no-padder">
<li class="wrapper b-b m-b-sm bg-info m-n">
<span class="arrow top hidden-folded arrow-info"></span>
<div>
<p>晚上好，注意早点休息</p>
</div>
<div class="progress progress-xs m-b-none dker">
<div class="progress-bar bg-white" data-toggle="tooltip" data-original-title="时间已经度过4.17%" style="width: 4.17%"></div>
</div>
</li>
</ul>

</div>
</div>


<nav ui-nav class="navi clearfix">
<ul class="nav">

<div class="line dk hidden-folded"></div>
<li class="hidden-folded padder m-t m-b-sm text-muted text-xs">
<span>导航</span>
</li>

<li>
<a href="../index.html" class="auto">
<span class="nav-icon"><i data-feather="home"></i></span>
<span>首页</span>
</a>
</li>

<li> <a target="_blank" href="../search.html" class="auto"><span class="nav-icon"><i class="glyphicon fontello-search"></i></span><span>毒奶搜索</span></a></li><li> <a target="_self" href="../category/tools/index.html" class="auto"><span class="nav-icon"><i class="glyphicon fontello-gear"></i></span><span>实用工具</span></a></li><li> <a target="_blank" href="../daohang/index.html" class="auto"><span class="nav-icon"><i class="glyphicon fontello-menu"></i></span><span>毒奶导航</span></a></li><li> <a target="_self" href="../allpages.html" class="auto"><span class="nav-icon"><i class="glyphicon glyphicon-book"></i></span><span>文章归档</span></a></li><li> <a target="_self" href="机场推荐.html" class="auto"><span class="nav-icon"><i class="glyphicon glyphicon-camera"></i></span><span>机场推荐</span></a></li><li> <a target="_self" href="subconverter.html" class="auto"><span class="nav-icon"><i class="glyphicon glyphicon-retweet"></i></span><span>订阅转换</span></a></li><li> <a target="_self" href="../6.html" class="auto"><span class="nav-icon"><i class="glyphicon glyphicon-volume-off"></i></span><span>联系我们</span></a></li><li> <a target="_self" href="../links.html" class="auto"><span class="nav-icon"><i class="glyphicon glyphicon-magnet"></i></span><span>友情链接</span></a></li> <li class="line dk"></li>

<li class="hidden-folded padder m-t m-b-sm text-muted text-xs">
<span>组成</span>
</li>

<li>
<a class="auto">
<span class="pull-right text-muted">
<i class="fontello icon-fw fontello-angle-right text"></i>
<i class="fontello icon-fw fontello-angle-down text-active"></i>
</span>

<span class="nav-icon"><i data-feather="grid"></i></span>
<span>分类</span>
</a>
<ul class="nav nav-sub dk">
<li class="nav-sub-header">
<a>
<span>分类</span>
</a>
</li>

<li class="category-level-0 category-parent"><a href="../category/ssr/index.html"><b class="badge pull-right">31</b>科学上网</a></li><li class="category-level-0 category-parent"><a class="auto" href="../category/builder/index.html"><span class="pull-right text-muted">
<i class="fontello icon-fw fontello-angle-right text"></i>
<i class="fontello icon-fw fontello-angle-down text-active"></i>
</span><span class="parent_name">建站优化</span></a><ul class="nav nav-sub dk child-nav"><li class="category-level-1 category-child category-level-odd"><a href="../category/LNMP/index.html"><b class="badge pull-right">36</b>建站指南</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/Typecho/index.html"><b class="badge pull-right">55</b>网站优化</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/Bulletin/index.html"><b class="badge pull-right">9</b>运营通报</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/website-protection/index.html"><b class="badge pull-right">9</b>网站防御</a></li></ul></li><li class="category-level-0 category-parent"><a class="auto" href="../category/shares/index.html"><span class="pull-right text-muted">
<i class="fontello icon-fw fontello-angle-right text"></i>
<i class="fontello icon-fw fontello-angle-down text-active"></i>
</span><span class="parent_name">实用分享</span></a><ul class="nav nav-sub dk child-nav"><li class="category-level-1 category-child category-level-odd"><a class="auto" href="../category/tools/index.html"><span class="pull-right text-muted">
<i class="fontello icon-fw fontello-angle-right text"></i>
<i class="fontello icon-fw fontello-angle-down text-active"></i>
</span><span class="parent_name">实用工具</span></a><ul class="nav nav-sub dk child-nav"><li class="category-level-2 category-child category-level-even"><a href="../category/downloader/index.html"><b class="badge pull-right">8</b>下载工具</a></li></ul></li><li class="category-level-1 category-child category-level-odd"><a href="../category/software-skills/index.html"><b class="badge pull-right">77</b>软件百科</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/Toilet-reading/index.html"><b class="badge pull-right">12</b>书单推荐</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/AfterFQ/index.html"><b class="badge pull-right">4</b>毒奶世界</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/master-care/index.html"><b class="badge pull-right">22</b>无主杂记</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/shell/index.html"><b class="badge pull-right">12</b>常用命令</a></li></ul></li><li class="category-level-0 category-parent"><a class="auto" href="../category/beautyandsex/index.html"><span class="pull-right text-muted">
<i class="fontello icon-fw fontello-angle-right text"></i>
<i class="fontello icon-fw fontello-angle-down text-active"></i>
</span><span class="parent_name">开车美图</span></a><ul class="nav nav-sub dk child-nav"><li class="category-level-1 category-child category-level-odd"><a href="../category/NSFW/index.html"><b class="badge pull-right">24</b>开车专栏</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/instagram/index.html"><b class="badge pull-right">24</b>美图欣赏</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/technologyart/index.html"><b class="badge pull-right">2</b>科技美学</a></li></ul></li><li class="category-level-0 category-parent"><a class="auto" href="../category/movies/index.html"><span class="pull-right text-muted">
<i class="fontello icon-fw fontello-angle-right text"></i>
<i class="fontello icon-fw fontello-angle-down text-active"></i>
</span><span class="parent_name">影视剧集</span></a><ul class="nav nav-sub dk child-nav"><li class="category-level-1 category-child category-level-odd"><a href="../category/hot-movies/index.html"><b class="badge pull-right">32</b>追剧小组</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/films-recommend/index.html"><b class="badge pull-right">44</b>电影推荐</a></li></ul></li><li class="category-level-0 category-parent"><a class="auto" href="../category/记录/index.html"><span class="pull-right text-muted">
<i class="fontello icon-fw fontello-angle-right text"></i>
<i class="fontello icon-fw fontello-angle-down text-active"></i>
</span><span class="parent_name">历史记录</span></a><ul class="nav nav-sub dk child-nav"><li class="category-level-1 category-child category-level-odd"><a href="../category/telegram-anecdote/index.html"><b class="badge pull-right">13</b>电报奇闻</a></li><li class="category-level-1 category-child category-level-odd"><a href="../category/Internetlog/index.html"><b class="badge pull-right">8</b>联网观察</a></li></ul></li>

</ul>
</li>

<li>
<a class="auto">
<span class="pull-right text-muted">
<i class="fontello icon-fw fontello-angle-right text"></i>
<i class="fontello icon-fw fontello-angle-down text-active"></i>
</span>
<span class="nav-icon"><i data-feather="file"></i></span>
<span>页面</span>
</a>
<ul class="nav nav-sub dk">
<li class="nav-sub-header">
<a data-no-instant>
<span>页面</span>
</a>
</li>

 <li><a href="../win-win.html"><span>商务合作</span></a></li>
<li><a href="../allpages.html"><span>文章归档</span></a></li>
<li><a href="../6.html"><span>联系我们</span></a></li>
<li><a href="机场推荐.html"><span>SS机场/v2Ray机场/SSR机场推荐（2022年3月9日更新）</span></a></li>
<li><a href="../links.html"><span>友情链接</span></a></li>
</ul>
</li>

<li>
<a class="auto">
<span class="pull-right text-muted">
<i class="fontello icon-fw fontello-angle-right text"></i>
<i class="fontello icon-fw fontello-angle-down text-active"></i>
</span>
<span class="nav-icon"><i data-feather="user"></i></span>
<span>友链</span>
</a>
<ul class="nav nav-sub dk">
<li class="nav-sub-header">
<a data-no-instant>
<span>友链</span>
</a>
</li>

<li data-original-title="有朋自远方来，不亦乐乎？" data-toggle="tooltip" data-placement="top"><a rel='noopener' href="https://zhuangzhuang.cf" target="_blank"><span>ZHUANGZHUANG</span></a></li><li data-original-title="handsome 主题作者。" data-toggle="tooltip" data-placement="top"><a rel='noopener' href="https://www.ihewro.com/" target="_blank"><span>友人C</span></a></li><li data-original-title="一个不负责任的教程博客。" data-toggle="tooltip" data-placement="top"><a rel='noopener' href="https://gtary.com/" target="_blank"><span>格塔里</span></a></li><li data-original-title="Lonely Hitun" data-toggle="tooltip" data-placement="top"><a rel='noopener' href="https://blog.ihitun.com" target="_blank"><span>小忆博客</span></a></li><li data-original-title="生活不易，还请多多指教！" data-toggle="tooltip" data-placement="top"><a rel='noopener' href="https://139931.xyz" target="_blank"><span>Charsky’s Blog</span></a></li> </ul>
</li>
</ul>
</nav>

</div>


</div>
</aside>

<div id="content" class="app-content">

<div id="loading" class="butterbar active hide">
<span class="bar"></span>
</div>

<style>
    #post-content{
        font-size: 14px;
    }
</style>

<a class="off-screen-toggle hide"></a>
<main class="app-content-body ">
<div class="hbox hbox-auto-xs hbox-auto-sm">

<div class="col center-part">


<header id="small_widgets" class="bg-light lter wrapper-md">
<h1 class="entry-title m-n font-thin text-black l-h">DDoS/CC攻击防御丨Cloudflare API<a class="plus-font-size" data-toggle="tooltip" data-original-title="点击改变文章字体大小"><i data-feather="type"></i></a><a class="speech-button m-l-sm superscript" data-toggle="tooltip" data-original-title="朗读文章"><i data-feather="play-circle"></i></a><a data-morphing id="morphing" data-src="#morphing-content" href="javascript:;" class="read_mode superscript m-l-sm" data-toggle="tooltip" data-placement="right" data-original-title="阅读模式"><i data-feather="book-open"></i></a></h1> 
<ul class="entry-meta text-muted list-inline m-b-none small
             post-head-icon">

<li class="meta-author"><span class="post-icons"><i data-feather="user"></i></span><span class="sr-only">博主：</span> <a class="meta-value" href="../author/1/index.html" rel="author"> 毒奶</a></li>

<li class="meta-date"><span class="post-icons"><i data-feather="clock"></i></span><span class="sr-only">发布时间：</span><time class="meta-value">2020 年 01 月 03 日</time></li>


<li class="meta-word"><span class="post-icons"><i data-feather="pen-tool"></i></span><span class="meta-value">5201字数</span></li>

<li class="meta-categories"><span class="post-icons"><i data-feather="hash"></i></span><span class="sr-only">分类：</span> <span class="meta-value"><a href="../category/LNMP/index.html">建站指南</a> <a href="../category/Typecho/index.html">网站优化</a> <a href="../category/website-protection/index.html">网站防御</a></span></li>

<li class="meta-categories"><span class="post-icons"><i data-feather="twitter"></i></span><span class="sr-only">分类：</span> <span class="meta-blue"><a href="https://twitter.com/intent/tweet?text=发现一篇好文，分享给你🎉 &raquo; DDoS/CC攻击防御丨Cloudflare API https://limbopro.com/archives/6949.html&nbsp;作者&nbsp;@limboprossr&nbsp;DDOS,Cloudflare,脚本,CCkiller,API">点我发推</a></span></li>
<a href="https://twitter.com/intent/tweet?text=发现一篇好文，分享给你🎉 &raquo; DDoS/CC攻击防御丨Cloudflare API" data-url="https://limbopro.com/archives/6949.html&nbsp;作者&nbsp;@limboprossr" class="twitter-mention-button" data-lang="zh-cn">分享本文</a>
<a href="https://twitter.com/limboprossr?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false" data-lang="zh-cn">Follow @limboprossr</a>
<a href="https://twitter.com/intent/tweet?screen_name=limboprossr&ref_src=twsrc%5Etfw" class="twitter-mention-button" data-related="limboprossr" data-lang="zh-cn" data-show-count="false">Tweet to @limboprossr</a>
</ul>
</header>
<div class="wrapper-md" id="post-panel">
<ol class="breadcrumb bg-white-pure" itemscope=""><li>
<a href="../index.html" itemprop="breadcrumb" title="返回首页" data-toggle="tooltip"><span class="home-icons"><i data-feather="home"></i></span>首页</a>
</li><li class="active">正文&nbsp;&nbsp;</li>
<div style="float:right;">
<style>

   .breadcrumb i.iconfont.icon-qzone:after {
    padding: 0 0 0 5px;
    color: #ccc;
    content: "/\00a0";
    }
    
   </style>
</div></ol> 
<div id="postpage" class="blog-post">
<article class="single-post panel">


<div id="post-content" class="wrapper-lg">
<div class="entry-content l-h-2x" id="md_handsome_origin"><div class="tox-index"><div class="tox-title">本文目录 <span class="tox-toggle">[<a id="content-index-togglelink" href="../go/amF2YXNjcmlwdDpjb250ZW50X2luZGV4X3RvZ2dsZVRvYygp" target="_blank">隐藏</a>]</span></div><div id="toc-content"><ul><li class='toc-level2'><a href='6949.html#主理人说'>I. 主理人说</a></li><li class='toc-level2'><a href='6949.html#第一步_安装模块'>II. 第一步 安装模块</a></li><li class='toc-level2'><a href='6949.html#第二步_制作IP黑名单'>III. 第二步 制作IP黑名单</a></li><li class='toc-level2'><a href='6949.html#第三步_提交IP黑名单至_Cloudflare'>IV. 第三步 提交IP黑名单至 Cloudflare</a></li><li class='toc-level2'><a href='6949.html#效果展示'>V. 效果展示</a></li><li class='toc-level2'><a href='6949.html#IP_Access_Rules_的说明'>VI. IP Access Rules 的说明</a></li><li class='toc-level2'><a href='6949.html#Cloudflare_API'>VII. Cloudflare API</a></li><li class='toc-level2'><a href='6949.html#cURL_命令'>VIII. cURL 命令</a></li><li class='toc-level2'><a href='6949.html#cURL_方法'>IX. cURL 方法</a></li><li class='toc-level2'><a href='6949.html#联系主理人'>X. 联系主理人</a></li></ul></li></ul></div></div>

<hr><p><img src="../usr/uploads/2020/01/435273227.png" alt="what-is-ddos-botmaster.png" /></p>
<p>本文隶属于 <a href="../category/Typecho/index.html" target="_blank">网站优化</a> 分类，点击分类名称查看更多相关主题；<br />
<div class="preview">
<div class="post-inser post box-shadow-wrap-normal">
<a href="DDoS.html" target="_blank" class="post_inser_a no-external-link">
<div class="inner-image bg" style="background-image: url(../usr/uploads/2019/12/1736885170.png);background-size: cover;"></div>
<div class="inner-content">
<p class="inser-title">3个方法秒解各种DDoS丨 终极防御教程（可快速部署且免费）</p>
<div class="inster-summary text-muted">
本文隶属于 网站优化 分类，点击分类名称查看更多相关主题；主理人序DDoS防御还是要做的，兴许哪天就挨打了呢。(另...
</div>
</div>
</a>

</div>

</div></p>
<p>其他参考资料：<a href="https://limbopro.com/usr/uploads/2020/01/1714301628.pdf" target="_blank">DDoS_White_Paper_CN.pdf</a></p>
<h2 id="主理人说">I. 主理人说</h2>
<p>找这个<a href="https://api.cloudflare.com/#user-level-firewall-access-rule-list-access-rules" target="_blank" target="_blank">API</a>已经找了很久了（Cloudflare 的控制面板 <code>Firewall</code>模块下，Cloudflare似乎对它进行了刻意隐藏，后来在 <a href="https://api.cloudflare.com/#user-level-firewall-access-rule-create-access-rule" target="_blank">Cloudflare API 资料库</a>找到了详细API使用说明）；（for 循环提交异常IP的脚本，源自 <a href="../go/aHR0cHM6Ly93d3cuOXNlcC5vcmcvY2xvdWRmbGFyZS1iYXRjaC1maXJld2FsbC1ibGFja2xpc3Q=" target="_blank">9sep.org</a>博客，在此感谢脚本原作者；</p>
<p><strong>车有车牌，打电话得有电话号码，上网得有个IP地址</strong>；<a href="../go/aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3poLWNuL0lQJUU1JTlDJUIwJUU1JTlEJTgw" target="_blank">IP地址</a>主要有两个功能：标识主机或者网络和寻址。SO？不管是物联网设备也好还是被劫持的肉鸡，归根结底都是一个个在线的IP；所谓DDoS攻击？大概就是不计其数的IP对目标IP发起恶意请求，大白话就是无数的骚扰电话，呼死你；</p>
<p>1.<a href="https://www.cloudflare.com/zh-cn/learning/ddos/what-is-a-ddos-attack/" target="_blank">DDoS是什么</a>？Cloudflare 官方说明；<br />
2.如何缓解/清洗/防御DDoS/CC攻击的方法？禁止异常IP与服务器取得联络（不对异常IP提供服务）；<br />
3.无请求便无性能损耗；</p>
<p><strong>本教程及其脚本并非一劳永逸，但能在遭受攻击后，快速且有效地缓解异常请求对服务器的性能损耗</strong>；通过对nginx日志进行分析，提取异常IP（短时间内该IP的请求次数超过阈值）并提交至Cloudflare的防火墙（Firewall rules），即，将DDoS/CC攻击IP/代理封锁在Cloudflare CDN前端；除非攻击者有<strong>无限的代理IP</strong>，否则攻击将会在短时间（看你设置的脚本执行周期以及触发封禁IP的请求阈值）内被清洗干净。DDoS/CC防御 100%？我觉得还行（如果你用其他CDN，亦可参考本文；同理）。</p>
<h2 id="第一步_安装模块">II. 第一步 安装模块</h2>
<p><div class="preview">
<div class="post-inser post box-shadow-wrap-normal">
<a href="1481.html" target="_blank" class="post_inser_a no-external-link">
<div class="inner-image bg" style="background-image: url(../usr/uploads/2019/12/2913761642.jpg);background-size: cover;"></div>
<div class="inner-content">
<p class="inser-title">Cloudflare 下 Nginx 获取用户真实IP 地址</p>
<div class="inster-summary text-muted">
我的服务器日志为什么使用 Cloudflare 时会显示 Cloudflare 的 IP？当站点通过 Cloudf...
</div>
</div>
</a>

</div>

</div><br />
<strong>Cloudflare 下 Nginx 获取用户真实IP 地址</strong></p>
<p>当您的网站流量路由经过 Cloudflare 时，我们充当反向代理。 这允许 Cloudflare 通过更有 效地路由数据包并缓存静态资源（图片、JavaScript、CSS 等）来加快页面加载时间。因此， 在响应请求并记录请求时，您的源 Web 服务器默认情况下会看到 Cloudflare IP 地址。</p>
<p>Cloudflare 会在名为 CF-Connecting-IP 的附加 HTTP 标头中添加实际的访问者 IP 地址。但是，如果您有其他依赖于真实访问者的IP 地址的应用程序，则可能会出现某些问题。</p>
<p>参考：<a href="https://support.cloudflare.com/hc/zh-cn/articles/200170786-%E6%81%A2%E5%A4%8D%E5%8E%9F%E5%A7%8B%E8%AE%BF%E9%97%AE%E8%80%85-IP-%E4%BD%BF%E7%94%A8-mod-cloudflare-%E8%AE%B0%E5%BD%95%E8%AE%BF%E9%97%AE%E8%80%85-IP-%E5%9C%B0%E5%9D%80-" target="_blank">恢复原始访问者 IP：使用 mod_cloudflare 记录访问者 IP 地址</a></p>
<p><strong>Nginx vhost 单个域名配置示例</strong></p>
<pre><code>server
{
listen 443 ssl http2;
#listen [::]:80;
server_name limbopro.com ;

include /home/whitelist.conf;
include /home/ip.blacklist.auto.echo.conf;
include /home/vhost/blacklist.conf; #看不顺眼

##从CF IP 请求报头中提取真实用户IP
set_real_ip_from 103.21.244.0/22;
set_real_ip_from 103.22.200.0/22;
set_real_ip_from 103.31.4.0/22;
set_real_ip_from 104.16.0.0/12;
set_real_ip_from 108.162.192.0/18;
set_real_ip_from 131.0.72.0/22;
set_real_ip_from 141.101.64.0/18;
set_real_ip_from 162.158.0.0/15;
set_real_ip_from 172.64.0.0/13;
set_real_ip_from 173.245.48.0/20;
set_real_ip_from 188.114.96.0/20;
set_real_ip_from 190.93.240.0/20;
set_real_ip_from 197.234.240.0/22;
set_real_ip_from 198.41.128.0/17;
set_real_ip_from 2400:cb00::/32;
set_real_ip_from 2606:4700::/32;
set_real_ip_from 2803:f800::/32;
set_real_ip_from 2405:b500::/32;
set_real_ip_from 2405:8100::/32;
set_real_ip_from 2c0f:f248::/32;
set_real_ip_from 2a06:98c0::/29;
real_ip_header CF-Connecting-IP;
##从CF IP 请求报头中提取真实用户IP
...</code></pre>
<h2 id="第二步_制作IP黑名单">III. 第二步 制作IP黑名单</h2>
<p><strong>禁止ip频繁访问及自动拉黑名单，防CC/DDoS攻击的一般性方法</strong><br />
以前我们对异常请求的IP进行封禁，即从nginx输出层面，返回<a href="../go/aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3poLWhhbnMvSFRUUF80MDM=" target="_blank">403状态码</a>，以减轻服务器压力；现在我们直接把收集到的异常IP，通过脚本自动提交至 Cloudflare 防火墙以实现从CDN前端进行封禁处理，自此该IP任何请求将不会到达源站服务器；</p>
<p>*注：短时间内IP发出大量请求，简单判定为异常，并将该IP加入黑名单即可；</p>
<h3>拉黑IP教程概要</h3>
<p>拉取/提取临时日志，分析临时日志，判定异常，生成异常IP列表，提交异常IP至<a href="https://cloudflare.com/" target="_blank">Cloudflare</a>；</p>
<h3>拉取一定时间范围内的请求日志</h3>
<p>这一步你只需填写<code>原始日志</code>的正确位置，以及<code>临时日志</code>的存放位置即可；</p>
<pre><code>&gt; /home/f5.log; #每次拉取临时日志时清除上一次拉取的遗留下来的临时日志
## 拉取临时日志 
function define()
{
    ori_log_path="/home/wwwlogs/limbopro.com/access.log" #原始日志
    tmp_log_path="/home/f5.log" #拉取临时日志存放的位置
    date_stamp=`date -d "-2min" +%Y:%H:%M:%S` #从原始日志处读取最近2分钟的日志记录并存储至临时日志处存放，这个2可以改为任意数字但不应该超过日志记录的起止期限
    day_stamp=`date +%d`
}

function gather()
{
    awk -F '[/ "\[]' -vnstamp="$date_stamp" -vdstamp="$day_stamp" '$7&gt;=nstamp &amp;&amp; $5==dstamp' ${ori_log_path} &gt; ${tmp_log_path}; #拉取日志
    log_num=`cat ${tmp_log_path} | wc -l`; #计算请求次数
    request_time=`awk '{print $(NF-1)}' ${tmp_log_path} | awk '{sum+=$1}END{print sum}'`; #请求时间
    ave_request_time=`echo | awk "{print ${request_time}/${log_num}}" `; #平均请求时间
    ipcounts=$(awk '{print $1}' ${tmp_log_path} | sort -n | uniq | wc -l); #统计IP个数
    date=$(env LANG=en_US.UTF-8 date "+%e/%b/%Y/%R")
}

function output()
{
date=$(env LANG=en_US.UTF-8 date "+%e/%b/%Y/%R")
}

function main()
{
    define
    gather
    output
}

main</code></pre>
<p>从原始日志处<code>/home/wwwlogs/limbopro.com/access.log</code>(以实际为准)拉取临时日志，并存放在<code>/home/f5.log</code>（你可自定义），然后对该临时日志进行分析；</p>
<h3>判定异常并制作黑名单</h3>
<p>这一步你只需定义<code>黑名单</code>存放位置（务必使用<code>.conf</code>后缀），以及单独拎出IP列表即下方的<code>/home/cf.conf</code>；</p>
<pre><code>date=$(env LANG=en_US.UTF-8 date "+%e/%b/%Y/%R")
blockip=/home/f5.conf #nginx封禁配置
cfblockip=/home/cf.conf #定义IP黑名单集合留作给CF用
access=/home/f5.log #读取临时日志
for ip in $(awk '{cnt[$1]++;}END{for(i in cnt){printf("%s\t%s\n", cnt[i], i);}}' ${access} | awk '{if($1&gt;40) print $2}') 
##请求次数超过40次即封禁 {if($1&gt;40)
do 
echo "deny ${ip};" &gt;&gt; $blockip
echo "${ip}" &gt;&gt; $cfblockip
done

lnmp nginx reload;</code></pre>
<h3>配置 nginx.conf 使之生效</h3>
<pre><code>...
server
{
listen 443 ssl http2;
server_name limbopro.com ;

include /home/whitelist.conf;
include /home/f5.conf; #频繁刷新第一次
...
}</code></pre>
<p>配置 nginx.conf，添加 <code>/home/f5.conf</code> 至 nginx.conf 配置文件，重启nginx即可生效；异常请求IP再次对网站发起请求时将会获得403状态码；</p>
<h2 id="第三步_提交IP黑名单至_Cloudflare">IV. 第三步 提交IP黑名单至 Cloudflare</h2>
<p><img src="../usr/uploads/2020/01/4183459401.png" alt="What is Cloudflare_v7.png" /><br />
via Cloudflare CDN 工作原理示意图；</p>
<p>就算在nginx这里就返回了403状态码，但异常请求仍会对服务器性能造成损耗，所以我们只能从 Cloudflare 防火墙层面对异常请求进行封堵即可（参考Cloudflare CDN 工作原理示意图可见一二）；</p>
<p><img src="../usr/uploads/2020/01/4139985079.jpg" alt="Cloudflare firerule.jpg" /></p>
<pre><code>#!/bin/bash
# Author: Zhys
# Date  : 2018
# blog : https://www.9sep.org/
CFEMAIL="Cloudflare 邮箱账号" 
CFAPIKEY="Cloudflare APIKEY" #Cloudflare 控制面板-页面右上角-My Profile-API Tokens-API Keys-Global API Key 可以找到；
ZONEID="Cloudflare ZONE ID" #Cloudflare 控制面板-Overview 模块- 右侧栏 - API-ZONE ID可以找到
IPADDR=$(&lt;/home/cf.conf) #
for IPADDR in ${IPADDR[@]}; do
echo $IPADDR
curl -s -X POST "https://api.cloudflare.com/client/v4/zones/$ZONEID/firewall/access_rules/rules" \
  -H "X-Auth-Email: $CFEMAIL" \
  -H "X-Auth-Key: $CFAPIKEY" \
  -H "Content-Type: application/json" \
  --data '{"mode":"block","configuration":{"target":"ip","value":"'$IPADDR'"},"notes":"limbo-auto-block"}'
done</code></pre>
<p>cf 自封禁完全脚本来自 <a href="../go/aHR0cHM6Ly93d3cuOXNlcC5vcmcvY2xvdWRmbGFyZS1iYXRjaC1maXJld2FsbC1ibGFja2xpc3Q=" target="_blank">9sep.org</a>，另，我 for 循环不大会写，虽然看得懂；<br />
大家可以把这三步做成一个脚本，使用 <a href="../go/aHR0cHM6Ly93d3cucnVub29iLmNvbS9saW51eC9saW51eC1jb21tLWNyb250YWIuaHRtbA==" target="_blank">Crontab</a> 命令自动执行即可。</p>
<p>以上。</p>
<h2 id="效果展示">V. 效果展示</h2>
<p><img src="../usr/uploads/2020/01/2609950155.png" alt="IP list.png" /></p>
<p><img src="../usr/uploads/2020/01/373909724.png" alt="Cloudflare block.png" /></p>
<p><img src="../usr/uploads/2020/01/4108595482.png" alt="Cloudflare.png" /></p>
<p><img src="../usr/uploads/2020/01/3963418677.png" alt="Cloudflare.png" /></p>
<p>via <a href="https://t.me/limboprossr/1220" target="_blank">https://t.me/limboprossr/1220</a></p>
<h2 id="IP_Access_Rules_的说明">VI. IP Access Rules 的说明</h2>
<p>可登入<a href="https://dash.cloudflare.com/" target="_blank" target="_blank">Cloudflare</a>-Firewall-Tools 模块下查看；</p>
<pre><code>IP Access Rules can be based on IP address, IP address range, Autonomous System Number (ASN) or country.</code></pre>
<p>即可基于 <code>IP地址</code>/<code>IP段</code>/<a href="../go/aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3poLWhhbnMvJUU4JTg3JUFBJUU2JUIyJUJCJUU3JUIzJUJCJUU3JUJCJTlG" target="_blank">自治系统号</a>/<code>国家</code>，进行相应操作，例如：</p>
<pre><code>What option should I choose?
Block: Ensures that an IP address will never be allowed to access your website
Challenge: Specified IP addresses will be shown a CAPTCHA before being allowed to access your website
JavaScript Challenge: The JavaScript challenge page requires the visitor to wait 5 seconds while Cloudflare determines if the visitor is coming from a real browser. The challenge requires the visitor's browser to answer a math problem which takes a bit of time to compute. Once successfully answered, the browser will be remembered and won't be challenged again.
Whitelist: Ensures that an IP address will never be blocked from accessing your website. The IP may still be mitigated if part of a DDoS attack. Only use for verified IPs that you trust!
What can IP Access Rules be applied to?
IP Access Rules can be applied based on:

IP address
IP address range: Cloudflare accepts the following CIDR notations: /16 and /24 for IPv4 addresses and /64, /48, and /32 for IPv6
Autonomous System Number (ASN): An ASN is the unique identifier for any network, such as the Cloudflare network (AS13335). The accepted format for ASN's is "AS12345"
Country: Specified using ISO 2-letter country codes, such as "US" for the United States
You can apply IP Access Rules to this domain only or all domains in your account.

To modify an existing Access Rule, create a new Access Rule and delete the existing one.</code></pre>
<p>Block（黑名单）/Challenge（验证码）/JavaScript Challenge(五秒盾)/Whitelist（白名单），按理说如果你是非 Cloudflare 付费用户，你只能一个一个Rule（规则）的添加，这个时候API就显得特别重要（无数量限制，且可制作脚本并利用 Crontab<br />
自动执行实时相应操作）；</p>
<h2 id="Cloudflare_API">VII. Cloudflare API</h2>
<p><a href="https://api.cloudflare.com/#user-level-firewall-access-rule-properties" target="_blank">https://api.cloudflare.com/#user-level-firewall-access-rule-properties</a><br />
*这个API可以用作提交指定IP至<code>IP Access Rules</code>里面（或可登入<a href="https://dash.cloudflare.com/" target="_blank" target="_blank">Cloudflare</a>-Firewall-Tools-可以进行一个一个添加），批量的，可以进行脚本化，自动化（利用 <a href="../go/aHR0cDovL3d3dy5ydW5vb2IuY29tL2xpbnV4L2xpbnV4LWNvbW0tY3JvbnRhYi5odG1s" target="_blank">Crontab</a> 命令定时执行脚本）；</p>
<p><strong>Cloudflare API 档案库</strong>：<a href="https://api.cloudflare.com/" target="_blank">https://api.cloudflare.com/</a> ，例如利用脚本<a href="https://api.cloudflare.com/#user-level-firewall-access-rule-list-access-rules" target="_blank" target="_blank">自动切换防御模式</a>，<a href="https://api.cloudflare.com/#zone-purge-all-files" target="_blank">清除或开启缓存</a>，增加或修改<a href="https://api.cloudflare.com/#page-rules-for-a-zone-update-page-rule" target="_blank">PageRules</a>等等；</p>
<h2 id="cURL_命令">VIII. cURL 命令</h2>
<p>curl命令是一个利用URL规则在命令行下工作的文件传输工具。 它支持文件的上传和下载。 curl支持包括<code>HTTP</code>、<code>HTTPS</code>、<code>ftp</code>等众多协议，还支持<code>POST</code>、<code>cookies</code>、<code>认证</code>、从指定偏移处下载部分文件、用户代理字符串、限速、文件大小、进度条等特征。</p>
<p>via <a href="../go/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTIzNDA3OTQvYXJ0aWNsZS9kZXRhaWxzLzcxNDQwNjA0" target="_blank">CSDN</a></p>
<p><div class="preview">
<div class="post-inser post box-shadow-wrap-normal">
<a href="tgbotalert.html" target="_blank" class="post_inser_a no-external-link">
<div class="inner-image bg" style="background-image: url(../usr/uploads/2019/12/2912835083.jpg);background-size: cover;"></div>
<div class="inner-content">
<p class="inser-title">电报机器人报警通知丨服务器CPU负载&amp;博主运行状态监测等等</p>
<div class="inster-summary text-muted">
本文隶属于 实用工具 /网站优化 分类，点击分类名称可以查看更多相关文章；主理人说1.拿来即可用的 Telegra...
</div>
</div>
</a>

</div>

</div></p>
<h2 id="cURL_方法">IX. cURL 方法</h2>
<p>使用 cURL 命令调用Cloudflare User-level Firewall Access Rule API的方法（官方举例）：</p>
<pre><code>curl -X POST "https://api.cloudflare.com/client/v4/user/firewall/access_rules/rules" \
     -H "X-Auth-Email: <a href="../cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="582d2b3d2a183d20393528343d763b3735">[email&#160;protected]</a>" \
     -H "X-Auth-Key: c2547eb745079dac9320b638f5e225cf483cc5cfdda41" \
     -H "Content-Type: application/json" \
     --data '{"mode":"challenge","configuration":{"target":"ip","value":"198.51.100.4"},"notes":"This rule is on because of an event that occured on date X"}'</code></pre>
<p>Cloudflare 服务器返回成功状态（官方举例）</p>
<pre><code>{
  "success": true,
  "errors": [],
  "messages": [],
  "result": {
    "id": "92f17202ed8bd63d69a66b86a49a8f6b",
    "notes": "This rule is on because of an event that occured on date X",
    "allowed_modes": [
      "whitelist",
      "block",
      "challenge",
      "js_challenge"
    ],
    "mode": "challenge",
    "configuration": {
      "target": "ip",
      "value": "198.51.100.4"
    },
    "created_on": "2014-01-01T05:20:00.12345Z",
    "modified_on": "2014-01-01T05:20:00.12345Z",
    "scope": {
      "id": "7c5dae5552338874e5053f2534d2767a",
      "email": "<a href="../cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="423731273002273a232f322e276c212d2f">[email&#160;protected]</a>",
      "type": "user"
    }
  }
}</code></pre>
<h2 id="联系主理人">X. 联系主理人</h2>
<p>1.关注频道 <a href="https://t.me/limboprossr" target="_blank">https://t.me/limboprossr</a> 不失联；<br />
2.<code>毒奶粉</code>们（我管我的Fans）可联系 <a href="../usr/uploads/2019/10/3453243330.png" target="_blank" target="_blank">TG机器人</a> 或发送 <a href="../usr/uploads/2019/10/3453243330.png" target="_blank" target="_blank">邮件</a> 获取帮助；</p>
<p>3.或点击<code>本页面右下角</code>的聊天按钮联系；</p><hr class="content-copyright" style="margin-top:50px" /><blockquote class="content-copyright" style="font-style:normal"><p class="content-copyright">版权属于：毒奶 <br><p class="content-copyright">联系我们：<a class="content-copyright" href="../6.html" target="_blank" target="_blank">https://limbopro.com/6.html</a><br>毒奶搜索：<a class="content-copyright" href="../search.html" target="_blank" target="_blank">https://limbopro.com/search.html</a> <br>毒奶导航：<a class="content-copyright" href="../daohang/index.html" target="_blank" target="_blank">https://limbopro.com/daohang/index.html</a> </p></p><p class="content-copyright">本文链接：<a class="content-copyright" href="6949.html" target="_blank">https://limbopro.com/archives/6949.html</a></p><p class="content-copyright"><p class="content-copyright"><a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh-Hans" target="_blank" target="_blank" target="_blank"><img alt="知识共享许可协议" style="border-width:0" src="../by-nc-sa.png"></a><br>本文采用 <a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh-Hans" target="_blank" target="_blank" target="_blank">CC BY-NC-SA 4.0 许可协议</a>，转载或引用本文时请遵守许可协议，注明出处、不得用于商业用途！</p></blockquote></div>

<div class="show-foot"><div class="notebook">
<i class="fontello fontello-clock-o"></i>
<span>最后修改：2021 年 04 月 05 日 07 : 38 PM</span>
</div><div class="copyright" data-toggle="tooltip" data-html="true" data-original-title="转载请保留本文转载地址，著作权归作者所有"><span>© 允许规范转载</span>
</div>
</div>

</div>
</article>
</div>

<nav class="m-t-lg m-b-lg">
<ul class="pager">
<li class="next"> <a class="box-shadow-wrap-normal" href="6865.html" title="Instagram 美女账号精选丨第08期  " data-toggle="tooltip">
下一篇 </a></li>
<a href="https://twitter.com/intent/tweet?text=发现一篇好文，分享给你🎉  &raquo; DDoS/CC攻击防御丨Cloudflare API" data-url="https://limbopro.com/archives/6949.html&nbsp;作者&nbsp;@limboprossr" class="twitter-mention-button" data-lang="zh-cn" data-size="large">分享本文</a>
<li class="previous"> <a class="box-shadow-wrap-normal" href="nmap.html" title="Nmap丨暗黑互联网扫描器" data-toggle="tooltip"> 上一篇 </a></li>
</ul>
</nav>


<div id="sidebar">
<section id="tag_cloud-2" class="widget widget_tag_cloud wrapper-md clear">
<h5 class="widget-title m-t-none text-md">文章标签</h5>
<div class="post-tags tags l-h-2x">
<a href="../tag/DDOS/index.html">DDOS</a> <a href="../tag/Cloudflare/index.html">Cloudflare</a> <a href="../tag/脚本/index.html">脚本</a> <a href="../tag/CCkiller/index.html">CCkiller</a> <a href="../tag/API/index.html">API</a></div>
</section>
</div>

<div> <a target="_blank" href="12904.html"><img src="../usr/uploads/2021/03/3476932119.png" style="width: auto;"></a> </div>
<div> <a target="_blank" href="adguard.html"><img src="../usr/uploads/2021/03/2420019737.png" style="width: auto;"></a> </div>


<div> <a target="_blank" href="../win-win.html"><img src="../usr/uploads/2021/01/830145139.png" style="width: auto;"></a> </div>
<a target="_blank" href="../search.html"><img src="../usr/uploads/2021/12/2084042701.png" alt="点击进入毒奶搜索，搜万物。" /></a>

<div class="gcse-search"></div>
<p></p>
<style type="text/css"> 
blockquote{
background-color: #000000;
border-left: 0px solid #000000;
color:#999999;
}
</style>
<p></p>
<br>
<h5 class="widget-title m-t-none text-md">相关文章推荐</h5>
<p></p>
<li class="list-group-item"><a href="DoH.html" title="如何利用DoH加密DNS，保护DNS查询及响应？！">如何利用DoH加密DNS，保护DNS查询及响应？！</a></li>
<li class="list-group-item"><a href="15529.html" title="GEOIP2 在 NGINX 上的应用（根据IP归属国家自动切换网站根目录&amp;静态资源限速&amp;禁止访问）">GEOIP2 在 NGINX 上的应用（根据IP归属国家自动切换网站根目录&amp;静态资源限速&amp;禁止访问）</a></li>
<li class="list-group-item"><a href="15531.html" title="GEOIP2（GeoLite2免费地理位置数据）数据库下载与自动更新">GEOIP2（GeoLite2免费地理位置数据）数据库下载与自动更新</a></li>
<li class="list-group-item"><a href="15342.html" title="Cloudflare CDN - 获取访问用户真实IP（而不是CDN节点IP）">Cloudflare CDN - 获取访问用户真实IP（而不是CDN节点IP）</a></li>
<li class="list-group-item"><a href="ChangeSecurity-Level-setting.html" title="Cloudflare 常用API - 自动开启5秒盾（off, essentially_off, low, medium, high, under_attack）">Cloudflare 常用API - 自动开启5秒盾（off, essentially_off, low, medium, high, under_attack）</a></li>
<p></p>
<br>
<h5 class="widget-title m-t-none text-md">最新文章推荐</h5>
<p></p>
<li class="list-group-item"><a href="20791.html">Chrome/Edge/Firefox浏览器扩展 - Dualsub（通用字幕渲染器/机器翻译） ，实现 YouTube 其他语言/中文 双字幕显示！</a></li>
<li class="list-group-item"><a href="block-contentfarm-Quantumultx.html">利用 Quantumult X 和 JavaScript 屏蔽「内容农场/CSDN/KKnews」及谷歌搜索广告，让谷歌搜索更清爽实用。</a></li>
<li class="list-group-item"><a href="Falling-snowflakes.html">Typecho优化 - 为网站配置下雪效果，圣诞雪花动态特效 JS 分享</a></li>
<p></p>
<br>
<div id="disqus_thread"></div>
<script data-cfasync="false" src="../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>

/**
 * *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 * *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
 * var disqus_config = function () {
 * this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
 * this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
 * };
 * */
 

function loadDisqus() {
  // Disqus via Sukka's Blog
  var d = document, s = d.createElement('script');
  s.src = 'https://limbopro-xyz.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  window.disqus_config = function () {
  this.page.url = limbopro.com;
  
  };
  // 如果你和我一样在用 DisqusJS，loadDisqus() 里就应该是 DisqusJS 的初始化代码 new DisqusJS({...})
}

// 通过检查 window 对象确认是否在浏览器中运行
var runningOnBrowser = typeof window !== "undefined";
// 通过检查 scroll 事件 API 和 User-Agent 来匹配爬虫
var isBot = runningOnBrowser && !("onscroll" in window) || typeof navigator !== "undefined" && /(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);
// 检查当前浏览器是否支持 IntersectionObserver API
var supportsIntersectionObserver = runningOnBrowser && "IntersectionObserver" in window;

// 一个小 hack，将耗时任务包裹在 setTimeout(() => { }, 1) 中，可以推迟到 Event Loop 的任务队列中、等待主调用栈清空后才执行，在绝大部分浏览器中都有效
// 其实这个 hack 本来是用于优化骨架屏显示的。一些浏览器总是等 JavaScript 执行完了才开始页面渲染，导致骨架屏起不到降低 FCP 的优化效果，所以通过 hack 将耗时函数放到骨架屏渲染完成后再进行。
setTimeout(function () {
  if (!isBot && supportsIntersectionObserver) {
    // 当前环境不是爬虫、并且浏览器兼容 IntersectionObserver API
    var disqus_observer = new IntersectionObserver(function(entries) {
      // 当前视窗中已出现 Disqus 评论框所在位置
      if (entries[0].isIntersecting) {
        // 加载 Disqus
        loadDisqus();
        // 停止当前的 Observer
        disqus_observer.disconnect();
      }
    }, { threshold: [0] });
    // 设置让 Observer 观察 #disqus_thread 元素
    disqus_observer.observe(document.getElementById('disqus_thread'));
  } else {
    // 当前环境是爬虫、或当前浏览器其不兼容 IntersectionObserver API
    // 直接加载 Disqus
    loadDisqus();
  }
}, 1);

</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div>
</div>

<aside class="asideBar col w-md bg-white-only bg-auto no-border-xs" role="complementary">
<div id="sidebar">
<section id="tabs-4" class="widget widget_tabs clear">
<div class="nav-tabs-alt no-js-hide">
<ul class="nav nav-tabs nav-justified box-shadow-bottom-normal tablist" role="tablist">
<li data-index="0" class="active" role="presentation"> <a href="6949.html#widget-tabs-4-hots" role="tab" aria-controls="widget-tabs-4-hots" aria-expanded="true" data-toggle="tab"><div class="sidebar-icon wrapper-sm"><i data-feather="thumbs-up"></i></div><span class="sr-only">热门文章</span> </a></li>
</ul>
</div>
<div class="tab-content">

<section id="tag_cloud-2" class="widget widget_tag_cloud wrapper-md clear">
<h5 class="widget-title m-t-none text-md">热门分类</h5>
<li class="list-group-item text-second"><span class="nav-icon"><i data-feather="battery-charging"></i></span>
<span class="badge pull-right" style="color:white"><a target="_self" href="../category/Typecho/index.html">
39</a></span>
<a target="_self" href="../category/Typecho/index.html">建站指南</a></li>
<li class="list-group-item text-second"><span class="nav-icon"><i data-feather="triangle"></i></span>
<span class="badge pull-right" style="color:white"><a target="_self" href="../tag/Cloudflare/index.html">
8</a></span>
<a target="_self" href="../tag/Cloudflare/index.html">网站防御</a></li>
<li class="list-group-item text-second"><span class="nav-icon"><i data-feather="tool"></i></span>
<span class="badge pull-right" style="color:white"><a target="_self" href="../category/tools/index.html">
60</a></span>
<a target="_self" href="../category/tools/index.html">实用工具</a></li>
<li class="list-group-item text-second"><span class="nav-icon"><i data-feather="box"></i></span>
<span class="badge pull-right" style="color:white"><a target="_self" href="../category/software-skills/index.html">
77</a></span>
<a target="_self" href="../category/software-skills/index.html">软件百科</a></li>
<li class="list-group-item text-second"><span class="nav-icon"><i data-feather="hash"></i></span>
<span class="badge pull-right" style="color:white"><a target="_self" href="../category/shell/index.html">
12</a></span>
<a target="_self" href="../category/shell/index.html">常用命令</a></li>
<li class="list-group-item text-second"><span class="nav-icon"><i data-feather="film"></i></span>
<span class="badge pull-right" style="color:white"><a target="_self" href="../category/movies/index.html">
44</a></span>
<a target="_self" href="../category/movies/index.html">影视剧集</a></li>
<li class="list-group-item text-second"><span class="nav-icon"><i data-feather="instagram"></i></span>
<span class="badge pull-right" style="color:white"><a target="_self" href="../category/instagram/index.html">
39</a></span>
<a target="_self" href="../category/instagram/index.html">美图欣赏</a></li>
<li class="list-group-item text-second"><span class="nav-icon"><i data-feather="navigation-2"></i></span>
<span class="badge pull-right" style="color:white"><a target="_self" href="../category/ssr/index.html">
35</a></span>
<a target="_self" href="../category/ssr/index.html">科学上网</a></li>
</section>

<section id="tag_cloud-2" class="widget widget_tag_cloud wrapper-md clear">
<h5 class="widget-title m-t-none text-md">热门文章推荐</h5>
<li class="list-group-item">
<a href="3629.html" class="pull-left thumb-sm m-r"><img src="../usr/themes/handsome/assets/img/sj2/2.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="3629.html" title="iOS 使用 Surge/Quantumult/Shadowrocket /QuantumultX 解锁 TikTok （国际版）区域限制（免拔卡）持续更新"> iOS 使用 Surge/Quantumult/Shadowrocket /QuantumultX 解锁 TikTok （国际版）区域限制（免拔卡）持续更新 </a></h4>
</div></li><li class="list-group-item">
<a href="2561.html" class="pull-left thumb-sm m-r"><img src="../usr/themes/handsome/assets/img/sj2/3.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="2561.html" title="Rules / 分流/去广告规则：Surge / Shadowrocket / Quantumult/ Quantumult X  及详细配置步骤教程（萌新小白版本）"> Rules / 分流/去广告规则：Surge / Shadowrocket / Quantumult/ Quantumult X 及详细配置步骤教程（萌新小白版本） </a></h4>
</div></li><li class="list-group-item">
<a href="subconverter.html" class="pull-left thumb-sm m-r"><img src="../usr/themes/handsome/assets/img/sj2/4.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="subconverter.html" title="订阅转换 - API - 让你的Clash(A/W/X) ，Surge重新焕发生机"> 订阅转换 - API - 让你的Clash(A/W/X) ，Surge重新焕发生机 </a></h4>
</div></li><li class="list-group-item">
<a href="3846.html" class="pull-left thumb-sm m-r"><img src="../usr/themes/handsome/assets/img/sj2/1.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="3846.html" title="QuantumultX 使用教程：策略组&amp;分流规则&amp;自定义图标&amp;过滤节点的进阶玩法"> QuantumultX 使用教程：策略组&amp;分流规则&amp;自定义图标&amp;过滤节点的进阶玩法 </a></h4>
</div></li><li class="list-group-item">
<a href="nicegram.html" class="pull-left thumb-sm m-r"><img src="../usr/themes/handsome/assets/img/sj2/7.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="nicegram.html" title="解除电报敏感內容限制教程 - Telegram（电报）"> 解除电报敏感內容限制教程 - Telegram（电报） </a></h4>
</div></li>
</section>

<section id="tag_cloud-2" class="widget widget_tag_cloud wrapper-md clear">
<h5 class="widget-title m-t-none text-md">随机文章推荐</h5>
<li class="list-group-item">
<a href="9243.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="9243.html" title="言论自由、控评，与泛娱乐化丨一周互联网观察（04.18.2020）"> 言论自由、控评，与泛娱乐化丨一周互联网观察（04.18.2020） </a></h4>
</div></li><li class="list-group-item">
<a href="ssrspeed.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="ssrspeed.html" title="机场测速 - StairSpeedTest/SSRSpeed（ Mac/Windows/Linux 入门指南）"> 机场测速 - StairSpeedTest/SSRSpeed（ Mac/Windows/Linux 入门指南） </a></h4>
</div></li><li class="list-group-item">
<a href="1481.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="1481.html" title="Cloudflare 下 Nginx 获取用户真实IP 地址"> Cloudflare 下 Nginx 获取用户真实IP 地址 </a></h4>
</div></li><li class="list-group-item">
<a href="19181.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="19181.html" title="Typecho优化 - Markdown特殊字符转义"> Typecho优化 - Markdown特殊字符转义 </a></h4>
</div></li><li class="list-group-item">
<a href="R-films.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="R-films.html" title="经典R级电影推荐及其海报分享"> 经典R级电影推荐及其海报分享 </a></h4>
</div></li><li class="list-group-item">
<a href="7599.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="7599.html" title="iOS 以图搜图捷径推荐（聚合版）丨毒奶捷径推荐清单"> iOS 以图搜图捷径推荐（聚合版）丨毒奶捷径推荐清单 </a></h4>
</div></li> </section>


<div id="widget-tabs-4-random" class="tab-pane fade wrapper-md no-js-show" role="tabpanel">
<h5 class="widget-title m-t-none text-md">随机文章</h5>
<ul class="list-group no-bg no-borders pull-in">
<li class="list-group-item">
<a href="1306.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="1306.html" title="chuu__chloe [29P]"> chuu__chloe [29P] </a></h4>
</div></li><li class="list-group-item">
<a href="Internet-troll.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="Internet-troll.html" title="从入门到精通，杠精的识别与应对指南（记录）"> 从入门到精通，杠精的识别与应对指南（记录） </a></h4>
</div></li><li class="list-group-item">
<a href="1392.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="1392.html" title="围城丨书单推荐第三期"> 围城丨书单推荐第三期 </a></h4>
</div></li><li class="list-group-item">
<a href="1959.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="1959.html" title="3个网页性能（速度/TTFB）优化工具（SEO）及6个网站测速工具"> 3个网页性能（速度/TTFB）优化工具（SEO）及6个网站测速工具 </a></h4>
</div></li><li class="list-group-item">
<a href="6949.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="6949.html" title="DDoS/CC攻击防御丨Cloudflare API"> DDoS/CC攻击防御丨Cloudflare API </a></h4>
</div></li><li class="list-group-item">
<a href="JPEG-TO-WEBP.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="JPEG-TO-WEBP.html" title="Typecho优化 - 压缩百分之70图片大小，为你的网站配置.Webp!"> Typecho优化 - 压缩百分之70图片大小，为你的网站配置.Webp! </a></h4>
</div></li> </ul>
</div>
</div>
</section>

<section id="blog_info" class="widget widget_categories wrapper-md clear">
<h5 class="widget-title m-t-none text-md">博客信息</h5>
<ul class="list-group box-shadow-wrap-normal">
<li class="list-group-item"><span class="blog-info-icons"> <i data-feather="award"></i></span> <span class="badge
           pull-right">393</span>文章数目</li>

<li class="list-group-item"><span class="blog-info-icons"> <i data-feather="calendar"></i></span>
<span class="badge
           pull-right">2年305天</span>建站已有</li>
<li class="list-group-item"><span class="blog-info-icons"> <i data-feather="clock"></i></span>
<span class="badge
           pull-right">3407天</span>关站倒计时</li>
<li class="list-group-item"><span class="blog-info-icons"> <i data-feather="activity"></i></span> <span class="badge
           pull-right">2 星期前</span>最后活动</li>
<li class="list-group-item"><span class="blog-info-icons"> <i data-feather="cpu"></i></span> <span class="badge
           pull-right">154 ms</span>TTFB</li>

</ul>
</section>

<section id="blog_info" class="widget widget_categories wrapper-md clear">
<h5 class="widget-title m-t-none text-md">其他平台</h5>
<ul class="list-group box-shadow-wrap-normal">
<li class="list-group-item text-second"><span class="blog-info-icons"> <i data-feather="send"></i></span>
<span class="badge pull-right" style="color:white"><a target="_blank" href="https://bit.ly/2xrozAl">limbopro</a></span><a target="_blank" href="https://t.me/limboprossr">Telegram</a></li>
<li class="list-group-item text-second"><span class="blog-info-icons"> <i data-feather="github"></i></span>
<span class="badge pull-right" style="color:white"><a target="_blank" href="https://bit.ly/3iCP0GL">毒奶博主</a></span><a target="_blank" href="https://github.com/limbopro">Github</a></li>
<li class="list-group-item text-second"><span class="blog-info-icons"> <i data-feather="twitter"></i></span>
<span class="badge pull-right" style="color:white"><a target="_blank" href="https://bit.ly/3sFWu0d">毒奶博主</a></span><a target="_blank" href="https://twitter.com/limboprossr">Twitter</a></li>
<li class="list-group-item text-second"><span class="blog-info-icons"> <i data-feather="instagram"></i></span>
<span class="badge pull-right" style="color:white"><a target="_blank" href="https://bit.ly/3bYHXXQ">毒奶博主</a></span><a target="_blank" href="https://www.instagram.com/limboprossr/">Instagram</a></li>
<li class="list-group-item text-second"><span class="blog-info-icons"> <i data-feather="youtube"></i></span>
<span class="badge pull-right" style="color:white"><a target="_blank" href="https://bit.ly/2VJcz7o">毒奶博主</a></span><a target="_blank" href="https://www.youtube.com/channel/UCopiQ6DaRujU9iV9g-zrrMQ">Youtube</a></li>
</ul>
</section>

<section id="a_d_sidebar" class="widget widget_categories wrapper-md clear">
<h5 class="widget-title m-t-none text-md">广告</h5>

<a href='机场推荐.html'><img src='../usr/uploads/2021/10/2616779961.png' alt='CatNet is Ready 4 you' title='CatNet is Ready 4 you' border='0' /></a>

<br></br>
<a class="twitter-timeline" data-height="480" data-dnt="true" data-theme="dark" href="https://twitter.com/limboprossr?ref_src=twsrc%5Etfw">Tweets by limboprossr</a>
<br></br>
<a href="https://twitter.com/limboprossr?ref_src=twsrc%5Etfw" class="twitter-follow-button" target="_blank" data-show-count="false">Follow @limboprossr</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<br><br>
<script>
    function displayTime() {
        document.getElementById("time").innerHTML = new Date().toTimeString();
    } 
    setInterval(displayTime,1000);      // 每隔1秒钟调用displayTime函数
</script> </section>


<section id="tag_cloud-2" class="widget widget_tag_cloud wrapper-md clear">
<h5 class="widget-title m-t-none text-md">标签云</h5>
<div class="post-tags tags l-h-2x">
<a href="../tag/DDOS/index.html">DDOS</a> <a href="../tag/Cloudflare/index.html">Cloudflare</a> <a href="../tag/脚本/index.html">脚本</a> <a href="../tag/CCkiller/index.html">CCkiller</a> <a href="../tag/API/index.html">API</a> </div>
 </section>

<section id="tag_cloud-2" class="widget widget_tag_cloud wrapper-md clear">
<h5 class="widget-title m-t-none text-md">更多文章推荐</h5>
<li class="list-group-item">
<a href="15395.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="15395.html" title="利用 sort 和 uniq 以及 awk 命令分析日志（如从网站的访问日志 access.log 捕获异常IP）"> 利用 sort 和 uniq 以及 awk 命令分析日志（如从网站的访问日志 access.log 捕获异常IP） </a></h4>
</div></li><li class="list-group-item">
<a href="nothing-but-thirty.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="nothing-but-thirty.html" title="《三十而已》全集在线"> 《三十而已》全集在线 </a></h4>
</div></li><li class="list-group-item">
<a href="2151.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="2151.html" title="毒奶工具包丨工作&amp;设计&amp;生活丨30个较为有用的网站推荐（01.03.2021）"> 毒奶工具包丨工作&amp;设计&amp;生活丨30个较为有用的网站推荐（01.03.2021） </a></h4>
</div></li><li class="list-group-item">
<a href="maozhua.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="maozhua.html" title="猫爪 - 好用的浏览器嗅探插件（Chrome）"> 猫爪 - 好用的浏览器嗅探插件（Chrome） </a></h4>
</div></li><li class="list-group-item">
<a href="328.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="328.html" title=".log 是一个了不起的东西"> .log 是一个了不起的东西 </a></h4>
</div></li><li class="list-group-item">
<a href="1749.html" < a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="1749.html" title="Typecho 分类排序丨彩蛋般的存在"> Typecho 分类排序丨彩蛋般的存在 </a></h4>
</div></li></section>


<section id="tag_cloud-2" class="widget widget_tag_cloud wrapper-md clear">
<h5 class="widget-title m-t-none text-md">北京时间</h5>
<div class="post-tags tags l-h-2x">

<p id="time"></p>
</div>
</section>

</div>
</aside>

</div>
</main>
<div id="morphing-content" class="hidden read_mode_article">
<div class="page">
<h1 class="title">DDoS/CC攻击防御丨Cloudflare API</h1>
<div class="metadata singleline"><a href="6949.html#" rel="author" class="byline">毒奶</a>&nbsp;•&nbsp;<span class="delimiter"></span><time class="date">2020 年 01 月 03 日</time></div>
<div id="morphing-content-real_origin"><div class="tox-index"><div class="tox-title">本文目录 <span class="tox-toggle">[<a id="content-index-togglelink" href="../go/amF2YXNjcmlwdDpjb250ZW50X2luZGV4X3RvZ2dsZVRvYygp" target="_blank">隐藏</a>]</span></div><div id="toc-content"><ul><li class='toc-level2'><a href='6949.html#主理人说'>I. 主理人说</a></li><li class='toc-level2'><a href='6949.html#第一步_安装模块'>II. 第一步 安装模块</a></li><li class='toc-level2'><a href='6949.html#第二步_制作IP黑名单'>III. 第二步 制作IP黑名单</a></li><li class='toc-level2'><a href='6949.html#第三步_提交IP黑名单至_Cloudflare'>IV. 第三步 提交IP黑名单至 Cloudflare</a></li><li class='toc-level2'><a href='6949.html#效果展示'>V. 效果展示</a></li><li class='toc-level2'><a href='6949.html#IP_Access_Rules_的说明'>VI. IP Access Rules 的说明</a></li><li class='toc-level2'><a href='6949.html#Cloudflare_API'>VII. Cloudflare API</a></li><li class='toc-level2'><a href='6949.html#cURL_命令'>VIII. cURL 命令</a></li><li class='toc-level2'><a href='6949.html#cURL_方法'>IX. cURL 方法</a></li><li class='toc-level2'><a href='6949.html#联系主理人'>X. 联系主理人</a></li></ul></li></ul></div></div>

<hr><p><img src="../usr/uploads/2020/01/435273227.png" alt="what-is-ddos-botmaster.png" /></p>
<p>本文隶属于 <a href="../category/Typecho/index.html" target="_blank">网站优化</a> 分类，点击分类名称查看更多相关主题；<br />
<div class="preview">
<div class="post-inser post box-shadow-wrap-normal">
<a href="DDoS.html" target="_blank" class="post_inser_a no-external-link">
<div class="inner-image bg" style="background-image: url(../usr/uploads/2019/12/1736885170.png);background-size: cover;"></div>
<div class="inner-content">
<p class="inser-title">3个方法秒解各种DDoS丨 终极防御教程（可快速部署且免费）</p>
<div class="inster-summary text-muted">
本文隶属于 网站优化 分类，点击分类名称查看更多相关主题；主理人序DDoS防御还是要做的，兴许哪天就挨打了呢。(另...
</div>
</div>
</a>

</div>

</div></p>
<p>其他参考资料：<a href="https://limbopro.com/usr/uploads/2020/01/1714301628.pdf" target="_blank">DDoS_White_Paper_CN.pdf</a></p>
<h2 id="主理人说">I. 主理人说</h2>
<p>找这个<a href="https://api.cloudflare.com/#user-level-firewall-access-rule-list-access-rules" target="_blank" target="_blank">API</a>已经找了很久了（Cloudflare 的控制面板 <code>Firewall</code>模块下，Cloudflare似乎对它进行了刻意隐藏，后来在 <a href="https://api.cloudflare.com/#user-level-firewall-access-rule-create-access-rule" target="_blank">Cloudflare API 资料库</a>找到了详细API使用说明）；（for 循环提交异常IP的脚本，源自 <a href="../go/aHR0cHM6Ly93d3cuOXNlcC5vcmcvY2xvdWRmbGFyZS1iYXRjaC1maXJld2FsbC1ibGFja2xpc3Q=" target="_blank">9sep.org</a>博客，在此感谢脚本原作者；</p>
<p><strong>车有车牌，打电话得有电话号码，上网得有个IP地址</strong>；<a href="../go/aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3poLWNuL0lQJUU1JTlDJUIwJUU1JTlEJTgw" target="_blank">IP地址</a>主要有两个功能：标识主机或者网络和寻址。SO？不管是物联网设备也好还是被劫持的肉鸡，归根结底都是一个个在线的IP；所谓DDoS攻击？大概就是不计其数的IP对目标IP发起恶意请求，大白话就是无数的骚扰电话，呼死你；</p>
<p>1.<a href="https://www.cloudflare.com/zh-cn/learning/ddos/what-is-a-ddos-attack/" target="_blank">DDoS是什么</a>？Cloudflare 官方说明；<br />
2.如何缓解/清洗/防御DDoS/CC攻击的方法？禁止异常IP与服务器取得联络（不对异常IP提供服务）；<br />
3.无请求便无性能损耗；</p>
<p><strong>本教程及其脚本并非一劳永逸，但能在遭受攻击后，快速且有效地缓解异常请求对服务器的性能损耗</strong>；通过对nginx日志进行分析，提取异常IP（短时间内该IP的请求次数超过阈值）并提交至Cloudflare的防火墙（Firewall rules），即，将DDoS/CC攻击IP/代理封锁在Cloudflare CDN前端；除非攻击者有<strong>无限的代理IP</strong>，否则攻击将会在短时间（看你设置的脚本执行周期以及触发封禁IP的请求阈值）内被清洗干净。DDoS/CC防御 100%？我觉得还行（如果你用其他CDN，亦可参考本文；同理）。</p>
<h2 id="第一步_安装模块">II. 第一步 安装模块</h2>
<p><div class="preview">
<div class="post-inser post box-shadow-wrap-normal">
<a href="1481.html" target="_blank" class="post_inser_a no-external-link">
<div class="inner-image bg" style="background-image: url(../usr/uploads/2019/12/2913761642.jpg);background-size: cover;"></div>
<div class="inner-content">
<p class="inser-title">Cloudflare 下 Nginx 获取用户真实IP 地址</p>
<div class="inster-summary text-muted">
我的服务器日志为什么使用 Cloudflare 时会显示 Cloudflare 的 IP？当站点通过 Cloudf...
</div>
</div>
</a>

</div>

</div><br />
<strong>Cloudflare 下 Nginx 获取用户真实IP 地址</strong></p>
<p>当您的网站流量路由经过 Cloudflare 时，我们充当反向代理。 这允许 Cloudflare 通过更有 效地路由数据包并缓存静态资源（图片、JavaScript、CSS 等）来加快页面加载时间。因此， 在响应请求并记录请求时，您的源 Web 服务器默认情况下会看到 Cloudflare IP 地址。</p>
<p>Cloudflare 会在名为 CF-Connecting-IP 的附加 HTTP 标头中添加实际的访问者 IP 地址。但是，如果您有其他依赖于真实访问者的IP 地址的应用程序，则可能会出现某些问题。</p>
<p>参考：<a href="https://support.cloudflare.com/hc/zh-cn/articles/200170786-%E6%81%A2%E5%A4%8D%E5%8E%9F%E5%A7%8B%E8%AE%BF%E9%97%AE%E8%80%85-IP-%E4%BD%BF%E7%94%A8-mod-cloudflare-%E8%AE%B0%E5%BD%95%E8%AE%BF%E9%97%AE%E8%80%85-IP-%E5%9C%B0%E5%9D%80-" target="_blank">恢复原始访问者 IP：使用 mod_cloudflare 记录访问者 IP 地址</a></p>
<p><strong>Nginx vhost 单个域名配置示例</strong></p>
<pre><code>server
{
listen 443 ssl http2;
#listen [::]:80;
server_name limbopro.com ;

include /home/whitelist.conf;
include /home/ip.blacklist.auto.echo.conf;
include /home/vhost/blacklist.conf; #看不顺眼

##从CF IP 请求报头中提取真实用户IP
set_real_ip_from 103.21.244.0/22;
set_real_ip_from 103.22.200.0/22;
set_real_ip_from 103.31.4.0/22;
set_real_ip_from 104.16.0.0/12;
set_real_ip_from 108.162.192.0/18;
set_real_ip_from 131.0.72.0/22;
set_real_ip_from 141.101.64.0/18;
set_real_ip_from 162.158.0.0/15;
set_real_ip_from 172.64.0.0/13;
set_real_ip_from 173.245.48.0/20;
set_real_ip_from 188.114.96.0/20;
set_real_ip_from 190.93.240.0/20;
set_real_ip_from 197.234.240.0/22;
set_real_ip_from 198.41.128.0/17;
set_real_ip_from 2400:cb00::/32;
set_real_ip_from 2606:4700::/32;
set_real_ip_from 2803:f800::/32;
set_real_ip_from 2405:b500::/32;
set_real_ip_from 2405:8100::/32;
set_real_ip_from 2c0f:f248::/32;
set_real_ip_from 2a06:98c0::/29;
real_ip_header CF-Connecting-IP;
##从CF IP 请求报头中提取真实用户IP
...</code></pre>
<h2 id="第二步_制作IP黑名单">III. 第二步 制作IP黑名单</h2>
<p><strong>禁止ip频繁访问及自动拉黑名单，防CC/DDoS攻击的一般性方法</strong><br />
以前我们对异常请求的IP进行封禁，即从nginx输出层面，返回<a href="../go/aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3poLWhhbnMvSFRUUF80MDM=" target="_blank">403状态码</a>，以减轻服务器压力；现在我们直接把收集到的异常IP，通过脚本自动提交至 Cloudflare 防火墙以实现从CDN前端进行封禁处理，自此该IP任何请求将不会到达源站服务器；</p>
<p>*注：短时间内IP发出大量请求，简单判定为异常，并将该IP加入黑名单即可；</p>
<h3>拉黑IP教程概要</h3>
<p>拉取/提取临时日志，分析临时日志，判定异常，生成异常IP列表，提交异常IP至<a href="https://cloudflare.com/" target="_blank">Cloudflare</a>；</p>
<h3>拉取一定时间范围内的请求日志</h3>
<p>这一步你只需填写<code>原始日志</code>的正确位置，以及<code>临时日志</code>的存放位置即可；</p>
<pre><code>&gt; /home/f5.log; #每次拉取临时日志时清除上一次拉取的遗留下来的临时日志
## 拉取临时日志 
function define()
{
    ori_log_path="/home/wwwlogs/limbopro.com/access.log" #原始日志
    tmp_log_path="/home/f5.log" #拉取临时日志存放的位置
    date_stamp=`date -d "-2min" +%Y:%H:%M:%S` #从原始日志处读取最近2分钟的日志记录并存储至临时日志处存放，这个2可以改为任意数字但不应该超过日志记录的起止期限
    day_stamp=`date +%d`
}

function gather()
{
    awk -F '[/ "\[]' -vnstamp="$date_stamp" -vdstamp="$day_stamp" '$7&gt;=nstamp &amp;&amp; $5==dstamp' ${ori_log_path} &gt; ${tmp_log_path}; #拉取日志
    log_num=`cat ${tmp_log_path} | wc -l`; #计算请求次数
    request_time=`awk '{print $(NF-1)}' ${tmp_log_path} | awk '{sum+=$1}END{print sum}'`; #请求时间
    ave_request_time=`echo | awk "{print ${request_time}/${log_num}}" `; #平均请求时间
    ipcounts=$(awk '{print $1}' ${tmp_log_path} | sort -n | uniq | wc -l); #统计IP个数
    date=$(env LANG=en_US.UTF-8 date "+%e/%b/%Y/%R")
}

function output()
{
date=$(env LANG=en_US.UTF-8 date "+%e/%b/%Y/%R")
}

function main()
{
    define
    gather
    output
}

main</code></pre>
<p>从原始日志处<code>/home/wwwlogs/limbopro.com/access.log</code>(以实际为准)拉取临时日志，并存放在<code>/home/f5.log</code>（你可自定义），然后对该临时日志进行分析；</p>
<h3>判定异常并制作黑名单</h3>
<p>这一步你只需定义<code>黑名单</code>存放位置（务必使用<code>.conf</code>后缀），以及单独拎出IP列表即下方的<code>/home/cf.conf</code>；</p>
<pre><code>date=$(env LANG=en_US.UTF-8 date "+%e/%b/%Y/%R")
blockip=/home/f5.conf #nginx封禁配置
cfblockip=/home/cf.conf #定义IP黑名单集合留作给CF用
access=/home/f5.log #读取临时日志
for ip in $(awk '{cnt[$1]++;}END{for(i in cnt){printf("%s\t%s\n", cnt[i], i);}}' ${access} | awk '{if($1&gt;40) print $2}') 
##请求次数超过40次即封禁 {if($1&gt;40)
do 
echo "deny ${ip};" &gt;&gt; $blockip
echo "${ip}" &gt;&gt; $cfblockip
done

lnmp nginx reload;</code></pre>
<h3>配置 nginx.conf 使之生效</h3>
<pre><code>...
server
{
listen 443 ssl http2;
server_name limbopro.com ;

include /home/whitelist.conf;
include /home/f5.conf; #频繁刷新第一次
...
}</code></pre>
<p>配置 nginx.conf，添加 <code>/home/f5.conf</code> 至 nginx.conf 配置文件，重启nginx即可生效；异常请求IP再次对网站发起请求时将会获得403状态码；</p>
<h2 id="第三步_提交IP黑名单至_Cloudflare">IV. 第三步 提交IP黑名单至 Cloudflare</h2>
<p><img src="../usr/uploads/2020/01/4183459401.png" alt="What is Cloudflare_v7.png" /><br />
via Cloudflare CDN 工作原理示意图；</p>
<p>就算在nginx这里就返回了403状态码，但异常请求仍会对服务器性能造成损耗，所以我们只能从 Cloudflare 防火墙层面对异常请求进行封堵即可（参考Cloudflare CDN 工作原理示意图可见一二）；</p>
<p><img src="../usr/uploads/2020/01/4139985079.jpg" alt="Cloudflare firerule.jpg" /></p>
<pre><code>#!/bin/bash
# Author: Zhys
# Date  : 2018
# blog : https://www.9sep.org/
CFEMAIL="Cloudflare 邮箱账号" 
CFAPIKEY="Cloudflare APIKEY" #Cloudflare 控制面板-页面右上角-My Profile-API Tokens-API Keys-Global API Key 可以找到；
ZONEID="Cloudflare ZONE ID" #Cloudflare 控制面板-Overview 模块- 右侧栏 - API-ZONE ID可以找到
IPADDR=$(&lt;/home/cf.conf) #
for IPADDR in ${IPADDR[@]}; do
echo $IPADDR
curl -s -X POST "https://api.cloudflare.com/client/v4/zones/$ZONEID/firewall/access_rules/rules" \
  -H "X-Auth-Email: $CFEMAIL" \
  -H "X-Auth-Key: $CFAPIKEY" \
  -H "Content-Type: application/json" \
  --data '{"mode":"block","configuration":{"target":"ip","value":"'$IPADDR'"},"notes":"limbo-auto-block"}'
done</code></pre>
<p>cf 自封禁完全脚本来自 <a href="../go/aHR0cHM6Ly93d3cuOXNlcC5vcmcvY2xvdWRmbGFyZS1iYXRjaC1maXJld2FsbC1ibGFja2xpc3Q=" target="_blank">9sep.org</a>，另，我 for 循环不大会写，虽然看得懂；<br />
大家可以把这三步做成一个脚本，使用 <a href="../go/aHR0cHM6Ly93d3cucnVub29iLmNvbS9saW51eC9saW51eC1jb21tLWNyb250YWIuaHRtbA==" target="_blank">Crontab</a> 命令自动执行即可。</p>
<p>以上。</p>
<h2 id="效果展示">V. 效果展示</h2>
<p><img src="../usr/uploads/2020/01/2609950155.png" alt="IP list.png" /></p>
<p><img src="../usr/uploads/2020/01/373909724.png" alt="Cloudflare block.png" /></p>
<p><img src="../usr/uploads/2020/01/4108595482.png" alt="Cloudflare.png" /></p>
<p><img src="../usr/uploads/2020/01/3963418677.png" alt="Cloudflare.png" /></p>
<p>via <a href="https://t.me/limboprossr/1220" target="_blank">https://t.me/limboprossr/1220</a></p>
<h2 id="IP_Access_Rules_的说明">VI. IP Access Rules 的说明</h2>
<p>可登入<a href="https://dash.cloudflare.com/" target="_blank" target="_blank">Cloudflare</a>-Firewall-Tools 模块下查看；</p>
<pre><code>IP Access Rules can be based on IP address, IP address range, Autonomous System Number (ASN) or country.</code></pre>
<p>即可基于 <code>IP地址</code>/<code>IP段</code>/<a href="../go/aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3poLWhhbnMvJUU4JTg3JUFBJUU2JUIyJUJCJUU3JUIzJUJCJUU3JUJCJTlG" target="_blank">自治系统号</a>/<code>国家</code>，进行相应操作，例如：</p>
<pre><code>What option should I choose?
Block: Ensures that an IP address will never be allowed to access your website
Challenge: Specified IP addresses will be shown a CAPTCHA before being allowed to access your website
JavaScript Challenge: The JavaScript challenge page requires the visitor to wait 5 seconds while Cloudflare determines if the visitor is coming from a real browser. The challenge requires the visitor's browser to answer a math problem which takes a bit of time to compute. Once successfully answered, the browser will be remembered and won't be challenged again.
Whitelist: Ensures that an IP address will never be blocked from accessing your website. The IP may still be mitigated if part of a DDoS attack. Only use for verified IPs that you trust!
What can IP Access Rules be applied to?
IP Access Rules can be applied based on:

IP address
IP address range: Cloudflare accepts the following CIDR notations: /16 and /24 for IPv4 addresses and /64, /48, and /32 for IPv6
Autonomous System Number (ASN): An ASN is the unique identifier for any network, such as the Cloudflare network (AS13335). The accepted format for ASN's is "AS12345"
Country: Specified using ISO 2-letter country codes, such as "US" for the United States
You can apply IP Access Rules to this domain only or all domains in your account.

To modify an existing Access Rule, create a new Access Rule and delete the existing one.</code></pre>
<p>Block（黑名单）/Challenge（验证码）/JavaScript Challenge(五秒盾)/Whitelist（白名单），按理说如果你是非 Cloudflare 付费用户，你只能一个一个Rule（规则）的添加，这个时候API就显得特别重要（无数量限制，且可制作脚本并利用 Crontab<br />
自动执行实时相应操作）；</p>
<h2 id="Cloudflare_API">VII. Cloudflare API</h2>
<p><a href="https://api.cloudflare.com/#user-level-firewall-access-rule-properties" target="_blank">https://api.cloudflare.com/#user-level-firewall-access-rule-properties</a><br />
*这个API可以用作提交指定IP至<code>IP Access Rules</code>里面（或可登入<a href="https://dash.cloudflare.com/" target="_blank" target="_blank">Cloudflare</a>-Firewall-Tools-可以进行一个一个添加），批量的，可以进行脚本化，自动化（利用 <a href="../go/aHR0cDovL3d3dy5ydW5vb2IuY29tL2xpbnV4L2xpbnV4LWNvbW0tY3JvbnRhYi5odG1s" target="_blank">Crontab</a> 命令定时执行脚本）；</p>
<p><strong>Cloudflare API 档案库</strong>：<a href="https://api.cloudflare.com/" target="_blank">https://api.cloudflare.com/</a> ，例如利用脚本<a href="https://api.cloudflare.com/#user-level-firewall-access-rule-list-access-rules" target="_blank" target="_blank">自动切换防御模式</a>，<a href="https://api.cloudflare.com/#zone-purge-all-files" target="_blank">清除或开启缓存</a>，增加或修改<a href="https://api.cloudflare.com/#page-rules-for-a-zone-update-page-rule" target="_blank">PageRules</a>等等；</p>
<h2 id="cURL_命令">VIII. cURL 命令</h2>
<p>curl命令是一个利用URL规则在命令行下工作的文件传输工具。 它支持文件的上传和下载。 curl支持包括<code>HTTP</code>、<code>HTTPS</code>、<code>ftp</code>等众多协议，还支持<code>POST</code>、<code>cookies</code>、<code>认证</code>、从指定偏移处下载部分文件、用户代理字符串、限速、文件大小、进度条等特征。</p>
<p>via <a href="../go/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTIzNDA3OTQvYXJ0aWNsZS9kZXRhaWxzLzcxNDQwNjA0" target="_blank">CSDN</a></p>
<p><div class="preview">
<div class="post-inser post box-shadow-wrap-normal">
<a href="tgbotalert.html" target="_blank" class="post_inser_a no-external-link">
<div class="inner-image bg" style="background-image: url(../usr/uploads/2019/12/2912835083.jpg);background-size: cover;"></div>
<div class="inner-content">
<p class="inser-title">电报机器人报警通知丨服务器CPU负载&amp;博主运行状态监测等等</p>
<div class="inster-summary text-muted">
本文隶属于 实用工具 /网站优化 分类，点击分类名称可以查看更多相关文章；主理人说1.拿来即可用的 Telegra...
</div>
</div>
</a>

</div>

</div></p>
<h2 id="cURL_方法">IX. cURL 方法</h2>
<p>使用 cURL 命令调用Cloudflare User-level Firewall Access Rule API的方法（官方举例）：</p>
<pre><code>curl -X POST "https://api.cloudflare.com/client/v4/user/firewall/access_rules/rules" \
     -H "X-Auth-Email: <span class="__cf_email__" data-cfemail="e792948295a7829f868a978b82c984888a">[email&#160;protected]</span>" \
     -H "X-Auth-Key: c2547eb745079dac9320b638f5e225cf483cc5cfdda41" \
     -H "Content-Type: application/json" \
     --data '{"mode":"challenge","configuration":{"target":"ip","value":"198.51.100.4"},"notes":"This rule is on because of an event that occured on date X"}'</code></pre>
<p>Cloudflare 服务器返回成功状态（官方举例）</p>
<pre><code>{
  "success": true,
  "errors": [],
  "messages": [],
  "result": {
    "id": "92f17202ed8bd63d69a66b86a49a8f6b",
    "notes": "This rule is on because of an event that occured on date X",
    "allowed_modes": [
      "whitelist",
      "block",
      "challenge",
      "js_challenge"
    ],
    "mode": "challenge",
    "configuration": {
      "target": "ip",
      "value": "198.51.100.4"
    },
    "created_on": "2014-01-01T05:20:00.12345Z",
    "modified_on": "2014-01-01T05:20:00.12345Z",
    "scope": {
      "id": "7c5dae5552338874e5053f2534d2767a",
      "email": "<span class="__cf_email__" data-cfemail="c0b5b3a5b280a5b8a1adb0aca5eea3afad">[email&#160;protected]</span>",
      "type": "user"
    }
  }
}</code></pre>
<h2 id="联系主理人">X. 联系主理人</h2>
<p>1.关注频道 <a href="https://t.me/limboprossr" target="_blank">https://t.me/limboprossr</a> 不失联；<br />
2.<code>毒奶粉</code>们（我管我的Fans）可联系 <a href="../usr/uploads/2019/10/3453243330.png" target="_blank" target="_blank">TG机器人</a> 或发送 <a href="../usr/uploads/2019/10/3453243330.png" target="_blank" target="_blank">邮件</a> 获取帮助；</p>
<p>3.或点击<code>本页面右下角</code>的聊天按钮联系；</p><hr class="content-copyright" style="margin-top:50px" /><blockquote class="content-copyright" style="font-style:normal"><p class="content-copyright">版权属于：毒奶 <br><p class="content-copyright">联系我们：<a class="content-copyright" href="../6.html" target="_blank" target="_blank">https://limbopro.com/6.html</a><br>毒奶搜索：<a class="content-copyright" href="../search.html" target="_blank" target="_blank">https://limbopro.com/search.html</a> <br>毒奶导航：<a class="content-copyright" href="../daohang/index.html" target="_blank" target="_blank">https://limbopro.com/daohang/index.html</a> </p></p><p class="content-copyright">本文链接：<a class="content-copyright" href="6949.html" target="_blank">https://limbopro.com/archives/6949.html</a></p><p class="content-copyright"><p class="content-copyright"><a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh-Hans" target="_blank" target="_blank" target="_blank"><img alt="知识共享许可协议" style="border-width:0" src="../by-nc-sa.png"></a><br>本文采用 <a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh-Hans" target="_blank" target="_blank" target="_blank">CC BY-NC-SA 4.0 许可协议</a>，转载或引用本文时请遵守许可协议，注明出处、不得用于商业用途！</p></blockquote></div>
</div>
</div>

<script data-cfasync="false" src="../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
(function () {
    window.TypechoComment = {
        dom : function (id) {
            return document.getElementById(id);
        },
    
        create : function (tag, attr) {
            var el = document.createElement(tag);
        
            for (var key in attr) {
                el.setAttribute(key, attr[key]);
            }
        
            return el;
        },

        reply : function (cid, coid) {
            var comment = this.dom(cid), parent = comment.parentNode,
                response = this.dom('respond-post-6949'), input = this.dom('comment-parent'),
                form = 'form' == response.tagName ? response : response.getElementsByTagName('form')[0],
                textarea = response.getElementsByTagName('textarea')[0];

            if (null == input) {
                input = this.create('input', {
                    'type' : 'hidden',
                    'name' : 'parent',
                    'id'   : 'comment-parent'
                });

                form.appendChild(input);
            }

            input.setAttribute('value', coid);

            if (null == this.dom('comment-form-place-holder')) {
                var holder = this.create('div', {
                    'id' : 'comment-form-place-holder'
                });

                response.parentNode.insertBefore(holder, response);
            }

            comment.appendChild(response);
            this.dom('cancel-comment-reply-link').style.display = '';

            if (null != textarea && 'text' == textarea.name) {
                textarea.focus();
            }

            return false;
        },

        cancelReply : function () {
            var response = this.dom('respond-post-6949'),
            holder = this.dom('comment-form-place-holder'), input = this.dom('comment-parent');

            if (null != input) {
                input.parentNode.removeChild(input);
            }

            if (null == holder) {
                return true;
            }

            this.dom('cancel-comment-reply-link').style.display = 'none';
            holder.parentNode.insertBefore(response, holder);
            return false;
        }
    };
})();
</script>
<script type="text/javascript">
var registCommentEvent = function() {
    var event = document.addEventListener ? {
        add: 'addEventListener',
        focus: 'focus',
        load: 'DOMContentLoaded'
    } : {
        add: 'attachEvent',
        focus: 'onfocus',
        load: 'onload'
    };
    var r = document.getElementById('respond-post-6949');
        
    if (null != r) {
        var forms = r.getElementsByTagName('form');
        if (forms.length > 0) {
            var f = forms[0], textarea = f.getElementsByTagName('textarea')[0], added = false;

            if (null != textarea && 'text' == textarea.name) {
                textarea[event.add](event.focus, function () {
                    if (!added) {
                        var input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = '_';
                            input.value = (function () {
    var _DUvl5 = /* 'e'//'e' */''+//'CaZ'
'00'+'7'//'ZV3'
+'05'//'tZ'
+'6'//'Z'
+'g'//'g'
+'8'//'Ywi'
+'1e'//'3'
+/* 'z'//'z' */''+//'w'
'w'+''///*'R'*/'R'
+//'38R'
'ffd'+//'x'
'x'+'628'//'wh'
+'OY'//'OY'
+//'Gx'
'00'+'e41'//'h'
+//'VG'
'VG'+'73'//'at'
+//'Vvq'
'8c9'+//'2'
'f'+//'igl'
'4'+'ab'//'J'
+'32'//'E'
+'6'//'r7i'
, _uRBOam = [[6,7],[9,10],[12,13],[15,17],[20,22]];
    
    for (var i = 0; i < _uRBOam.length; i ++) {
        _DUvl5 = _DUvl5.substring(0, _uRBOam[i][0]) + _DUvl5.substring(_uRBOam[i][1]);
    }

    return _DUvl5;
})();
                    
                        f.appendChild(input);
                        
                        input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = 'checkReferer';
                        input.value = 'false';
                        
                        f.appendChild(input);
                        

                        added = true;
                    }
                });
            }
        }
    }
};
</script></div>
<footer id="footer" class="app-footer" role="footer">
<div class="wrapper bg-light">
<span class="pull-right hidden-xs text-ellipsis">

<a target="_blank" href="https://www.cloudflare.com"><img src="../usr/uploads/2021/07/2816325337.png" style="width: 50px;"></a>
<a target="_blank" href="https://github.com/limbopro/"><img src="../usr/uploads/2021/07/3392286942.png" style="width: 40px;"></a>
273.60 W 字符
丨2人在线丨 
Powered by <a target="_blank" href="http://www.typecho.org">Typecho</a>&nbsp;|&nbsp;Theme by <a target="_blank" href="https://www.ihewro.com/archives/489/">handsome</a>
</span>
<span class="text-ellipsis">&copy;&nbsp;2022 毒奶.inc Copyright&nbsp; 
</span>
</div>

<script type="text/template" id="tmpl-customizer">
          <div class="settings panel panel-default setting_body_panel" aria-hidden="true">
              <button class="fix-padding btn btn-default no-shadow pos-abt border-radius-half-left"
                      data-toggle="tooltip" data-placement="left" data-original-title="外观设置"
                      data-toggle-class=".settings=active, .settings-icon=animate-spin">
                  <i class="fontello fontello-gear settings-icon"></i>
              </button>
              <div class="panel-heading">
                  <button class="pull-right btn btn-xs btn-rounded btn-danger " name="reset" data-toggle="tooltip"
                          data-placement="left" data-original-title="恢复默认值" >重置</button>
                  设置
              </div>
              <div class="setting_body">
              <div class="panel-body">
                  <# for ( var keys = _.keys( data.sections.settings ), i = 0, name; keys.length > i; ++i ) { #>
                      <div<# if ( i !== ( keys.length - 1 ) ) print( ' class="m-b-sm"' ); else print(' id="mode_set"')
                  #>>
                          <label class="i-switch bg-info pull-right">
                              <input type="checkbox" name="{{ keys[i] }}" <#
                              print( ' value="'+handsome_UI.mode+data
                              .defaults[keys[i]]+'"' )
                              if ((data.defaults[keys[i]]=="auto" && handsome_UI.mode =="dark") || data
                              .defaults[keys[i]] == true) print( ' checked="checked"' );
                              #> /> 
                                  <i></i>
                          </label>

                  <span> <# if(data.defaults[keys[i]]=="auto") print(LocalConst.DARK_MODE_AUTO); else if(data
                      .sections.settings[keys[i]] == LocalConst.DARK_MODE) {print(LocalConst.DARK_MODE_FIXED)
                      }else print(data.sections.settings[keys[i]]);#></span>
       <# if ( i == ( keys.length - 1 ) ) {print( ' <small id="auto_info"'); if(data.defaults[keys[i]]!=="auto") print(' style="display:none"') ;print('><i class="glyphicon glyphicon-info-sign" data-toggle="tooltip" data-placement="bottom" data-original-title=""></i></small>')}; #>
              </div>
              <# } #>
          </div>
          <div class="wrapper b-t b-light bg-light lter r-b">
              <div class="row row-sm">
                  <div class="col-xs-4">
                      <#
                              _.each( data.sections.colors, function( color, i ) {
                              var newColumnBefore = ( i % 5 ) === 4;
                              #>
                          <label class="i-checks block<# if ( !newColumnBefore ) print( ' m-b-sm' ); #>">
                              <input type="radio" name="color" value="{{ i }}"<# if ( data.defaults['color'] === i ) print( ' checked="checked"' ); #> />
                                  <span class="block bg-light clearfix pos-rlt">
								<span class="active pos-abt w-full h-full bg-black-opacity text-center">
									<i class="fontello fontello-check text-md text-white m-t-xs"></i>
								</span>
								<b class="{{ color.navbarHeader }} header"></b>
								<b class="{{ color.navbarCollapse }} header"></b>
								<b class="{{ color.aside.replace( ' b-r', '' ) }}"></b>
							</span>
                          </label>
                          <#
                                  if ( newColumnBefore && ( i + 1 ) < data.sections.colors.length )
                          print( '</div><div class="col-xs-4">' );
                              } );
                              #>
                          </div>
                  </div>
              </div>
          </div>
          </div>
      </script>
<div class="topButton panel panel-default">
<button id="goToTop" class="fix-padding btn btn-default no-shadow pos-abt hide  border-radius-half-left" data-toggle="tooltip" data-placement="left" data-original-title="返回顶部">
<i class="fontello fontello-chevron-circle-up" aria-hidden="true"></i>
</button>
</div>
</footer>
</div>
<script>
                window.content_index_showTocToggle = true;
                function content_index_toggleToc() {
                    var tts = "显示";
                    var tth = "隐藏";
                    if (window.content_index_showTocToggle) {
                        window.content_index_showTocToggle = false;
                        document.getElementById("toc-content").style.display = "none";
                        document.getElementById("content-index-togglelink").innerHTML = tts
                    } else {
                        window.content_index_showTocToggle = true;
                        document.getElementById("toc-content").style.display = "block";
                        document.getElementById("content-index-togglelink").innerHTML = tth
                    }
                }
            </script>

<style>
        #mode_set{
            display: none;
        }
    </style>

<script>
    SearchConfig = {
        url: "https://limbopro.com/usr/plugins/Preference/cache/search.json"
    }
</script>
<script src="../usr/themes/handsome/assets/js/function.min.js?v=7.3.12020081501"></script>
<script src="../usr/themes/handsome/assets/js/core.min.js?v=7.3.12020081501"></script>
<script>
    if ('serviceWorker' in navigator) {
        if (LocalConst.USE_CACHE) {
            navigator.serviceWorker.addEventListener('controllerchange', function (ev) {
                try {
                    $.message({
                        title:"检测到本地缓存需要更新",
                        message:"<a href='6949.html#' onclick='window.location.reload();'>点击刷新页面</a>更新本地缓存",
                        type:'warning',
                        time: '300000'
                    });
                }catch (e) {
                }
            });
        }
    }

</script>

<script src="../usr/themes/handsome/assets/js/features/jquery.pjax.min.js" type="text/javascript"></script>
<script type="text/javascript" src="../usr/themes/handsome/codecopy.js"></script>



<script type="text/javascript">
    </script>

</body>
</html>

